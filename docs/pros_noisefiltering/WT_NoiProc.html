<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 13.1.1"/>
    <title>pros_noisefiltering.WT_NoiProc API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../pros_noisefiltering.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;pros_noisefiltering</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#filt_butter_factory">filt_butter_factory</a>
            </li>
            <li>
                    <a class="function" href="#filter_Butter_default">filter_Butter_default</a>
            </li>
            <li>
                    <a class="class" href="#WT_NoiseChannelProc">WT_NoiseChannelProc</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#WT_NoiseChannelProc.__init__">WT_NoiseChannelProc</a>
                        </li>
                        <li>
                                <a class="function" href="#WT_NoiseChannelProc.set_description">set_description</a>
                        </li>
                        <li>
                                <a class="variable" href="#WT_NoiseChannelProc.operations">operations</a>
                        </li>
                        <li>
                                <a class="variable" href="#WT_NoiseChannelProc.data_as_Series">data_as_Series</a>
                        </li>
                        <li>
                                <a class="function" href="#WT_NoiseChannelProc.average">average</a>
                        </li>
                        <li>
                                <a class="function" href="#WT_NoiseChannelProc.set_desc">set_desc</a>
                        </li>
                        <li>
                                <a class="function" href="#WT_NoiseChannelProc.decimate">decimate</a>
                        </li>
                        <li>
                                <a class="function" href="#WT_NoiseChannelProc.filter">filter</a>
                        </li>
                        <li>
                                <a class="function" href="#WT_NoiseChannelProc.calc_spectrum">calc_spectrum</a>
                        </li>
                        <li>
                                <a class="function" href="#WT_NoiseChannelProc.calc_spectrum_gen">calc_spectrum_gen</a>
                        </li>
                        <li>
                                <a class="function" href="#WT_NoiseChannelProc.plot_filtered_th">plot_filtered_th</a>
                        </li>
                        <li>
                                <a class="function" href="#WT_NoiseChannelProc.from_tdms">from_tdms</a>
                        </li>
                        <li>
                                <a class="function" href="#WT_NoiseChannelProc.from_obj">from_obj</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Plotter_Class">Plotter_Class</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Plotter_Class.plot_signal_all_doms">plot_signal_all_doms</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#plot_comparative_response">plot_comparative_response</a>
            </li>
            <li>
                    <a class="function" href="#fir_factory_constructor">fir_factory_constructor</a>
            </li>
            <li>
                    <a class="function" href="#filter_fir_default">filter_fir_default</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../pros_noisefiltering.html">pros_noisefiltering</a><wbr>.WT_NoiProc    </h1>

                        <div class="docstring"><p>Main class for processing a tdms dataframe.</p>
</div>

                        <input id="mod-WT_NoiProc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-WT_NoiProc-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;Main class for processing a tdms dataframe.&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="c1"># %%</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="c1"># from pathlib import Path</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="c1"># logging should go before matplotlib</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">import</span> <span class="nn">logging</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">import</span> <span class="nn">scipy.signal</span> <span class="k">as</span> <span class="nn">signal</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">import</span> <span class="nn">nptdms</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="c1"># from nptdms import TdmsFile</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">import</span> <span class="nn">pyqtgraph</span> <span class="k">as</span> <span class="nn">pg</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">import</span> <span class="nn">pyqtgraph.exporters</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">from</span> <span class="nn">pros_noisefiltering.gen_functions</span> <span class="kn">import</span> <span class="n">spect</span><span class="p">,</span> <span class="n">FFT_new</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">from</span> <span class="nn">pros_noisefiltering.Graph_data_container</span> <span class="kn">import</span> <span class="n">Graph_data_container</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="c1"># %% Functions and classes</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="k">def</span> <span class="nf">filt_butter_factory</span><span class="p">(</span><span class="n">filt_order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct a factory method that produces a BUTTERWORTH filter function.</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">    Here we construct a butterworth IIR filter with a filter order and</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">    a cutoff frequency passed as arguments. The function returns a filter using</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">    `scipy.signal` module to generate the it.</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">    Args:</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">    - filt_order (int, optional)  : Filter order. Defaults to 2.</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">    - fc_Hz (float, optional)     : cut off frequency in Hz (defaults to 100)</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>    <span class="k">def</span> <span class="nf">filt_butter</span><span class="p">(</span><span class="n">ds</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>                    <span class="n">fs_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>                    <span class="n">filt_order</span><span class="o">=</span><span class="n">filt_order</span><span class="p">):</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply filtering to np.array with fs_Hz data, with cuffoff frequency.</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">        Args:</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">        - ds (np.ndarray): data signal object</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">        - fs_Hz (float): sampling frequency</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">        - fc_Hz (int, optional): cutoff frequency of filter(low pass def:100)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">        - filt_order (int, optional): The order of the filter (number of</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">        coeff.) to be produced. Defaults to 2. def:2</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">        Returns:</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">        - filtered (signal.sosfilt()): The filter with cutoff and order defined</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">        as arguments</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>        <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">filt_order</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>                            <span class="s1">&#39;lp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">,</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>                            <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>        <span class="n">filtered</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">ds</span><span class="o">-</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>        <span class="k">return</span> <span class="n">filtered</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>    <span class="c1"># additional decoration sith params dictionary</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>    <span class="c1"># this is used instead of a class</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>    <span class="n">filt_butter</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;filter order&#39;</span><span class="p">:</span> <span class="n">filt_order</span><span class="p">,</span> <span class="s1">&#39;fc_Hz&#39;</span><span class="p">:</span> <span class="n">fc_Hz</span><span class="p">}</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>    <span class="k">return</span> <span class="n">filt_butter</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="n">filter_Butter_default</span> <span class="o">=</span> <span class="n">filt_butter_factory</span><span class="p">(</span><span class="n">filt_order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="k">class</span> <span class="nc">WT_NoiseChannelProc</span><span class="p">():</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for processing a tdms file for noise processing.&quot;&quot;&quot;</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>    <span class="n">__measurement_history</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>                 <span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">group_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">_channel_data</span><span class="p">,</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>                 <span class="n">operations</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize constructor for managing tdms files.&quot;&quot;&quot;</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_channel_data</span> <span class="o">=</span> <span class="n">_channel_data</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">)</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>        <span class="c1"># process details</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span> <span class="o">=</span> <span class="n">fs_Hz</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">channel_name</span> <span class="o">=</span> <span class="n">channel_name</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">group_name</span> <span class="o">=</span> <span class="n">group_name</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__measurement_history</span> <span class="o">=</span> <span class="n">operations</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>    <span class="k">def</span> <span class="nf">set_description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc</span><span class="p">):</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the description of the file.</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">        Args:</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">            desc (_type_): _description_</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">desc</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>    <span class="nd">@property</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>    <span class="k">def</span> <span class="nf">operations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Capture operations on data.&quot;&quot;&quot;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__measurement_history</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>    <span class="nd">@property</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>    <span class="k">def</span> <span class="nf">data_as_Series</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the raw data as a pd.Series.</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">        Returns:</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">            _type_: _description_</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name</span><span class="si">}</span><span class="s1">:raw&#39;</span><span class="p">)</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>    <span class="k">def</span> <span class="nf">average</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fr_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return another object.</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">        Args:</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">        - fr_Hz (float) : recording frequency (with averaging)</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">        - desc (str) : description</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">            - Defaults to None: ie. add suffix _Av:&lt;fr_Hz&gt;)</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>        <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_as_Series</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="n">fs_Hz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>        <span class="n">ds_fr</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="p">(</span><span class="n">fs_Hz</span> <span class="o">/</span> <span class="n">fr_Hz</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="n">description</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>            <span class="n">desc</span> <span class="k">if</span> <span class="n">desc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;_Av:</span><span class="si">{</span><span class="n">fr_Hz</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>        <span class="c1"># TODO need to think better the naming conventions</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>        <span class="c1"># (consider using a dictionary with multiple keys</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>        <span class="c1"># e.g. different for plots etc)</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>        <span class="n">new_operations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>        <span class="n">new_operations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Apply Averaging :</span><span class="si">{</span><span class="n">fr_Hz</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="k">return</span> <span class="n">WT_NoiseChannelProc</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>                                   <span class="n">fs_Hz</span><span class="o">=</span><span class="n">fr_Hz</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ds_fr</span><span class="p">,</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>                                   <span class="n">channel_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name</span><span class="p">,</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>                                   <span class="n">group_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">group_name</span><span class="p">,</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>                                   <span class="n">_channel_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>                                   <span class="n">operations</span><span class="o">=</span><span class="n">new_operations</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>                                   <span class="p">)</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>    <span class="k">def</span> <span class="nf">set_desc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set description for any operation or info for the data object.&quot;&quot;&quot;</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>        <span class="k">return</span> <span class="n">WT_NoiseChannelProc</span><span class="o">.</span><span class="n">from_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>                                            <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">)</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">decimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dec</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a decimated data seires.</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">        Args:</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">        - dec (int): decimation factor</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">        - offset (int): initial offset</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">        Returns:</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">        - WT_NoiseChannelProc.obj: a decimated data series.</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>        <span class="n">decimated_fs_Hz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span><span class="o">/</span><span class="n">dec</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="n">new_operation</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>            <span class="sa">f</span><span class="s1">&#39;Decimation factor:</span><span class="si">{</span><span class="n">dec</span><span class="si">}</span><span class="s1">, Offset:</span><span class="si">{</span><span class="n">offset</span><span class="si">}</span><span class="s1">, new fs_Hz:</span><span class="si">{</span><span class="n">decimated_fs_Hz</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="k">return</span> <span class="n">WT_NoiseChannelProc</span><span class="o">.</span><span class="n">from_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>                                            <span class="n">operation</span><span class="o">=</span><span class="n">new_operation</span><span class="p">,</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>                                            <span class="n">fs_Hz</span><span class="o">=</span><span class="n">decimated_fs_Hz</span><span class="p">,</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>                                            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">offset</span><span class="p">::</span><span class="n">dec</span><span class="p">])</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>    <span class="k">def</span> <span class="nf">_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>                <span class="n">filter_func</span><span class="o">=</span><span class="n">filter_Butter_default</span><span class="p">,</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>                <span class="n">fs_Hz</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a filtered signal based on.</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">        Args:</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">            fc_Hz (float): cut off frequency in Hz</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">            filter_func (filt_butter_factory, optional): filtering function</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">                        that thates two arguments (ds, fs_Hz).</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">                        Defaults to 100, filt_order = 2).</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">            fs_Hz (None): sampling frequency in Hz (#TODO SHOULD BE REMOVED)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">        Returns:</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="sd">            _type_: _description_</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>        <span class="k">if</span> <span class="n">fs_Hz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>                <span class="sa">f</span><span class="s1">&#39;issued </span><span class="si">{</span><span class="n">fs_Hz</span><span class="si">}</span><span class="s1"> sampling frequency while the default is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="n">fs_Hz</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>            <span class="n">fs_Hz</span> <span class="k">if</span> <span class="n">fs_Hz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span><span class="p">)</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="n">filtered</span> <span class="o">=</span> <span class="n">filter_func</span><span class="p">(</span><span class="n">ds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>                               <span class="n">fs_Hz</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">,</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>                               <span class="n">fc_Hz</span><span class="o">=</span><span class="n">fc_Hz</span><span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>                         <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name</span><span class="si">}</span><span class="s1">:filt_fc_</span><span class="si">{</span><span class="n">fc_Hz</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>               <span class="n">filter_func</span><span class="o">=</span><span class="n">filter_Butter_default</span><span class="p">,</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>               <span class="n">fs_Hz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter a signal with the chosen factory method (IIR, FIR).&quot;&quot;&quot;</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>        <span class="n">ds_filt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter</span><span class="p">(</span><span class="n">fc_Hz</span><span class="o">=</span><span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>                               <span class="n">filter_func</span><span class="o">=</span><span class="n">filter_func</span><span class="p">,</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>                               <span class="n">fs_Hz</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">)</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>        <span class="c1"># description = (</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        <span class="c1">#     desc if desc is not None else self.description + f&quot;_fc:{fc_Hz}&quot;)</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>        <span class="k">return</span> <span class="n">WT_NoiseChannelProc</span><span class="o">.</span><span class="n">from_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>                                            <span class="n">data</span><span class="o">=</span><span class="n">ds_filt</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>                                            <span class="n">operation</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;pass filter </span><span class="si">{</span><span class="n">fc_Hz</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>                                            <span class="p">)</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>    <span class="k">def</span> <span class="nf">calc_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>                      <span class="n">window</span><span class="o">=</span><span class="s1">&#39;flattop&#39;</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">1_024</span><span class="p">,</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>                      <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graph_data_container</span><span class="p">:</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Graph_data_container object.</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="sd">        with:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="sd">        - the power spectrum of the data.</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">        - uses the decimation function</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="sd">        Returns:</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">        - classmethod: Graph_data_container</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="n">gobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_spectrum_gen</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>                                      <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="n">scaling</span><span class="p">)</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="k">return</span> <span class="n">gobj</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>    <span class="k">def</span> <span class="nf">calc_spectrum_gen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dec</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>                          <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>                          <span class="n">window</span><span class="o">=</span><span class="s1">&#39;flattop&#39;</span><span class="p">,</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>                          <span class="n">nperseg</span><span class="o">=</span><span class="mi">1_024</span><span class="p">,</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>                          <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graph_data_container</span><span class="p">:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create function for calculating the spectrum of a time series.</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a><span class="sd">        Return a Graph_data_container object with the power spectrum</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a><span class="sd">        of the **decimated** data.</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a><span class="sd">        Args:</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a><span class="sd">        - dec (int): decimation factor</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a><span class="sd">        - offset (int, optional): offset.</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a><span class="sd">            - Defaults to 0.</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="sd">        Returns:</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">        - Graph_data_container: Containing the spectral density of the given</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="sd">        signal.</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>        <span class="n">decimated_fs_Hz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span><span class="o">/</span><span class="n">dec</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>        <span class="n">x_r</span><span class="p">,</span> <span class="n">y_r</span> <span class="o">=</span> <span class="n">spect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">offset</span><span class="p">::</span><span class="n">dec</span><span class="p">],</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>                         <span class="n">FS</span><span class="o">=</span><span class="n">decimated_fs_Hz</span><span class="p">,</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>                         <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>                         <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>                         <span class="n">scaling</span><span class="o">=</span><span class="n">scaling</span><span class="p">)</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>        <span class="k">if</span> <span class="n">dec</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>            <span class="c1"># TODO the new chain method approach does not require this.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>            <span class="c1"># This is a remnant from the original approach.</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name</span><span class="si">}</span><span class="s1">-fs:</span><span class="si">{</span><span class="n">decimated_fs_Hz</span><span class="o">/</span><span class="mi">1000</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">kHz &#39;</span><span class="p">)</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>        <span class="k">return</span> <span class="n">Graph_data_container</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_r</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_r</span><span class="p">,</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>                                    <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>    <span class="k">def</span> <span class="nf">plot_filtered_th</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_func</span><span class="p">):</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the Time History.</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="sd">        Args:</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="sd">        - filter_func (factory method): Choose the wanted filter</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">)</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">filter_func</span><span class="o">=</span><span class="n">filter_func</span><span class="p">),</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;filtered: </span><span class="si">{</span><span class="n">filter_func</span><span class="o">.</span><span class="n">params</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>    <span class="k">def</span> <span class="nf">from_tdms</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">tdms_channel</span><span class="p">:</span> <span class="n">nptdms</span><span class="o">.</span><span class="n">tdms</span><span class="o">.</span><span class="n">TdmsChannel</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;## Initiate factory method that generates an object class.</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">        #### TOD need to change the init function and test.</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">        Args:</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">        - tdms_channel (nptdms.tdms.TdmsChannel): tmds channel name</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">        - desc (str): descirption (used)</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>        <span class="n">_channel_data</span> <span class="o">=</span> <span class="n">tdms_channel</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>        <span class="c1"># desc</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>        <span class="n">fs_Hz</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">_channel_data</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s1">&#39;wf_increment&#39;</span><span class="p">]</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">_channel_data</span><span class="o">.</span><span class="n">data</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>        <span class="n">channel_name</span> <span class="o">=</span> <span class="n">_channel_data</span><span class="o">.</span><span class="n">name</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="n">group_name</span> <span class="o">=</span> <span class="n">_channel_data</span><span class="o">.</span><span class="n">group_name</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">group_name</span><span class="p">,</span> <span class="n">_channel_data</span><span class="p">,</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>                   <span class="n">operations</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>                       <span class="sa">f</span><span class="s1">&#39;Loaded from tdms file </span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">channel_name</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">fs_Hz</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>    <span class="k">def</span> <span class="nf">from_obj</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;## Create factory method that generates an object class.</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a><span class="sd">        ### If parameters are not provided the obj values are used.</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">        Args:</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">            tdms_channel (nptdms.tdms.TdmsChannel): tmds channel</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">            desc (str): descirption (used)</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operation</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="kc">None</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>        <span class="c1"># the following line allows to pass a description maybe</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>        <span class="n">desc</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">description</span> <span class="k">if</span> <span class="p">(</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>                <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="n">_channel_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_channel_data&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">_channel_data</span><span class="p">)</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="n">fs_Hz</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fs_Hz&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">fs_Hz</span><span class="p">)</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>        <span class="n">channel_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;channel_name&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">channel_name</span><span class="p">)</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>        <span class="n">group_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;group_name&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">group_name</span><span class="p">)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="n">new_ops</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>        <span class="k">if</span> <span class="n">operation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>            <span class="n">new_ops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">operation</span><span class="p">)</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">group_name</span><span class="p">,</span> <span class="n">_channel_data</span><span class="p">,</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>                   <span class="n">operations</span><span class="o">=</span><span class="n">new_ops</span><span class="p">)</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="c1"># %%</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a><span class="k">class</span> <span class="nc">Plotter_Class</span><span class="p">():</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;# This is a class that can take different objects for plotting.</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a><span class="sd">    Takes their raw data and plots:</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="sd">    - a overview for the signal in frequency and time domains</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="sd">    - Time histories (Not Implemented)</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">    - spectrums (Not Implemented)</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>    <span class="c1"># def __init__(self):</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>    <span class="c1">#     &quot;&quot;&quot;Reuse original self object.&quot;&quot;&quot;</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>    <span class="c1">#     super.__init__()</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>    <span class="k">def</span> <span class="nf">plot_signal_all_doms</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">filt_func</span><span class="o">=</span><span class="n">filter_Butter_default</span><span class="p">):</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot a coprehensive and analytical figure with the signal info.</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a><span class="sd">        Construct a GraphicsLayoutWidget and place many graphs in it.</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a><span class="sd">        - Raw and filtered signal in first row</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a><span class="sd">            - filtering with</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a><span class="sd">                - butterworth IIR filter</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a><span class="sd">                - simple FIR filter</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a><span class="sd">        - frequency domain of the filtered fignal</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a><span class="sd">            - using fft algorithm</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a><span class="sd">        - Spectral density of the filtered signal</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a><span class="sd">            - with Welch&#39;s method</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a><span class="sd">        Parameters</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a><span class="sd">        ---</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a><span class="sd">        - signal:</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a><span class="sd">            - WT_NoiseChannelProc object</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a><span class="sd">        Returns</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a><span class="sd">        ---</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a><span class="sd">        - win:</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a><span class="sd">            - GraphicsLayoutWidget.GraphicsLayoutWidget object</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>        <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">signals</span><span class="p">:</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>            <span class="n">filtrd</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">fc_Hz</span><span class="o">=</span><span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;fc_Hz&#39;</span><span class="p">],</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>                                 <span class="n">filter_func</span><span class="o">=</span><span class="n">filt_func</span><span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>            <span class="c1"># make a nice legend for filtered plot</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>            <span class="k">if</span> <span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;filter order&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">:</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>                <span class="n">filtrd</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>                    <span class="sa">f</span><span class="s1">&#39;simple FIR low-pass </span><span class="si">{</span><span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;fc_Hz&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>            <span class="k">elif</span> <span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;filter order&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">:</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>                <span class="n">filtrd</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>                    <span class="sa">f</span><span class="s1">&#39;butterworth IIR low-pass </span><span class="si">{</span><span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;fc_Hz&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>            <span class="n">freq_dom_filtrd</span> <span class="o">=</span> <span class="n">FFT_new</span><span class="p">(</span><span class="n">filtrd</span><span class="p">,</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>                                      <span class="n">title</span><span class="o">=</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>                                      <span class="sa">f</span><span class="s2">&quot;Time domain filtered with </span><span class="si">{</span><span class="n">filtrd</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>            <span class="n">win</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">GraphicsLayoutWidget</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>                                          <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Basic plotting examples&quot;</span><span class="p">)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>            <span class="n">win</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">)</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>            <span class="n">win</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;pyqtgraph example: Plotting&#39;</span><span class="p">)</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>            <span class="c1"># Enable antialiasing for prettier plots</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>            <span class="n">pg</span><span class="o">.</span><span class="n">setConfigOptions</span><span class="p">(</span><span class="n">antialias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>            <span class="n">p1_raw</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">addPlot</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>                                 <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>                                 <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>                                 <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">each</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">(m/s)&quot;</span><span class="p">)</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>            <span class="n">p1_raw</span><span class="o">.</span><span class="n">setLabels</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;time duration (s)&#39;</span><span class="p">,</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>                             <span class="n">left</span><span class="o">=</span><span class="s1">&#39;Raw sensor Voltage&#39;</span><span class="p">,)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>            <span class="n">p1_raw</span><span class="o">.</span><span class="n">showGrid</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>            <span class="n">p1_raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_dom_filtrd</span><span class="o">.</span><span class="n">time_sec</span><span class="p">,</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>                        <span class="n">each</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>                        <span class="n">pen</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Raw signal&quot;</span><span class="p">)</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>            <span class="n">p1_filt</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">addPlot</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>                                  <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>                                  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Filtered signal&#39;</span><span class="p">)</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">setLabels</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;time duration (s)&#39;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">showGrid</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">addLegend</span><span class="p">()</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">setYRange</span><span class="p">(</span><span class="n">filtrd</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>                              <span class="n">filtrd</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_dom_filtrd</span><span class="o">.</span><span class="n">time_sec</span><span class="p">,</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>                         <span class="n">filtrd</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>                         <span class="n">pen</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>                         <span class="n">name</span><span class="o">=</span><span class="p">(</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>                             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filtrd</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>            <span class="n">p2_filt_fft</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">addPlot</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>                                      <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>                                      <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>                                      <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>                                      <span class="n">padding</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>                                      <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Filtered signal Frequency domain representation&quot;</span><span class="p">)</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">freq_dom_filtrd</span><span class="o">.</span><span class="n">fft_calc</span><span class="p">()</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>            <span class="n">p2_filt_fft</span><span class="o">.</span><span class="n">setLogMode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>            <span class="n">p2_filt_fft</span><span class="o">.</span><span class="n">showGrid</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>            <span class="n">p2_filt_fft</span><span class="o">.</span><span class="n">setLabels</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;Frequencies in Hz&#39;</span><span class="p">,</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>                                  <span class="n">left</span><span class="o">=</span><span class="s1">&#39;Power/Freq&#39;</span><span class="p">,</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>                                  <span class="n">top</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>            <span class="c1"># p2.setLabel(axis=&#39;bottom&#39;, text=&#39;Frequencies in Hz&#39;)</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>            <span class="c1"># p2.setLabel(axis=&#39;left&#39;, text=&#39;Power/Freq&#39;)</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>            <span class="n">p2_filt_fft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>                             <span class="n">pen</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>                             <span class="n">fillLevel</span><span class="o">=-</span><span class="mi">18</span><span class="p">,</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>                             <span class="n">brush</span><span class="o">=</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>            <span class="n">p3_filt_spect</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">addPlot</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>                                        <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>                                        <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>                                        <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>                                        <span class="n">padding</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>                                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Filtered signal Spectral density (welch)&quot;</span><span class="p">)</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>            <span class="n">welch</span> <span class="o">=</span> <span class="n">filtrd</span><span class="o">.</span><span class="n">calc_spectrum_gen</span><span class="p">(</span><span class="n">nperseg</span><span class="o">=</span><span class="mi">1024</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>            <span class="n">p3_filt_spect</span><span class="o">.</span><span class="n">setLogMode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>            <span class="n">p3_filt_spect</span><span class="o">.</span><span class="n">showGrid</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>            <span class="n">p3_filt_spect</span><span class="o">.</span><span class="n">setLabels</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;Frequencies in Hz&#39;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;dB&#39;</span><span class="p">,</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>                                    <span class="n">top</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>            <span class="c1"># p3_filt_spect.setYRange(-5, -18)</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>            <span class="c1"># p2.setLabel(axis=&#39;bottom&#39;, text=&#39;Frequencies in Hz&#39;)</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>            <span class="c1"># p2.setLabel(axis=&#39;left&#39;, text=&#39;Power/Freq&#39;)</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>            <span class="n">p3_filt_spect</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">welch</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">welch</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>                               <span class="n">pen</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>                               <span class="n">fillLevel</span><span class="o">=-</span><span class="mi">18</span><span class="p">,</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>                               <span class="n">brush</span><span class="o">=</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>            <span class="c1"># save to a file somewhere</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>            <span class="n">exporter</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">exporters</span><span class="o">.</span><span class="n">ImageExporter</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">scene</span><span class="p">())</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>            <span class="n">exporter</span><span class="o">.</span><span class="n">parameters</span><span class="p">()[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1920</span>   <span class="c1"># also effects the height</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>            <span class="n">exporter</span><span class="o">.</span><span class="n">parameters</span><span class="p">()[</span><span class="s1">&#39;antialias&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>            <span class="c1"># exporter.export(&#39;./sig_proc_plots/test.jpg&#39;)</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>            <span class="c1"># print(&quot;1&quot;)</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>            <span class="n">pg</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>            <span class="c1"># pass</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="k">def</span> <span class="nf">plot_comparative_response</span><span class="p">(</span><span class="n">wt_obj</span><span class="p">,</span>   <span class="c1"># cutoff frequency</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>                              <span class="n">filter_func</span><span class="p">,</span> <span class="n">response_offset</span><span class="o">=</span><span class="mf">2e-4</span><span class="p">,</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>                              <span class="n">Kolmogorov_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>                              <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>                              <span class="n">nperseg</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>                              <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">1e1</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">],</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>                              <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">],</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>                              <span class="n">plot_th</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;#TOD make this part of WT_NoiProc.</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="sd">    Args:</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">    - wt_obj (Graph_data_container): List of graph containers</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a><span class="sd">    - response_offset (float, optional): Setting a response offset.</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a><span class="sd">        - Defaults to 2e-4.</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a><span class="sd">    - figsize (tuple, optional): Determining the size of the produced figure.</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a><span class="sd">        - Defaults to (16,9).</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>    <span class="n">sig</span> <span class="o">=</span> <span class="n">wt_obj</span><span class="o">.</span><span class="n">data</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>    <span class="n">fs_Hz</span> <span class="o">=</span> <span class="n">wt_obj</span><span class="o">.</span><span class="n">fs_Hz</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>    <span class="n">filt_p</span> <span class="o">=</span> <span class="n">filter_func</span><span class="o">.</span><span class="n">params</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">filt_p</span><span class="p">[</span><span class="s1">&#39;filter order&#39;</span><span class="p">],</span> <span class="n">Wn</span><span class="o">=</span><span class="n">filt_p</span><span class="p">[</span><span class="s1">&#39;fc_Hz&#39;</span><span class="p">],</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>                        <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;lp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>    <span class="n">filtered</span> <span class="o">=</span> <span class="n">filter_func</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">)</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>    <span class="c1"># calculate spectrum</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>    <span class="n">f</span><span class="p">,</span> <span class="n">Pxx_spec</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">,</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>                               <span class="n">window</span><span class="o">=</span><span class="s1">&#39;flattop&#39;</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>                               <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>    <span class="n">f</span><span class="p">,</span> <span class="n">Pxx_spec_filt</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">,</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>                                    <span class="n">window</span><span class="o">=</span><span class="s1">&#39;flattop&#39;</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>                                    <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>    <span class="c1"># #TODO: this is for testing</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>    <span class="c1"># Pxx_spec= Pxx_spec**2</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>    <span class="c1"># Pxx_spec_filt = Pxx_spec_filt**2</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>    <span class="k">if</span> <span class="n">plot_th</span><span class="p">:</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sig</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>                      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs_Hz</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>        <span class="c1"># plot time domain</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>        <span class="n">fig1</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>                                        <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>                                        <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>        <span class="n">fig1</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>            <span class="s1">&#39;Time Domain Filtering of signal with f1=10[Hz], f2=20[Hz] and noise&#39;</span><span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;raw signal&#39;</span><span class="p">)</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>        <span class="c1"># ax1.axis([0, 1, -2, 2])</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">filtered</span><span class="p">)</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;After filter&#39;</span><span class="p">)</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>        <span class="c1"># ax2.axis([0, 1, -2, 2])</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [seconds]&#39;</span><span class="p">)</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>    <span class="n">wb</span><span class="p">,</span> <span class="n">hb</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfreqz</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>                             <span class="n">whole</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">)</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>    <span class="n">fb</span> <span class="o">=</span> <span class="n">wb</span>   <span class="c1"># /(2*np.pi) # convert rad/s to Hz</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>    <span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>                             <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fb</span><span class="p">,</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>             <span class="n">response_offset</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hb</span><span class="p">)),</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;filter response&#39;</span><span class="p">)</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Pxx_spec</span><span class="p">),</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">)</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Pxx_spec_filt</span><span class="p">),</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;filtered&#39;</span><span class="p">)</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>    <span class="k">if</span> <span class="n">Kolmogorov_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>        <span class="n">KOLMOGORV_CONSTANT</span> <span class="o">=</span> <span class="o">-</span> <span class="mf">5.0</span><span class="o">/</span><span class="mi">3</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>        <span class="n">xs</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>        <span class="n">ys</span> <span class="o">=</span> <span class="n">xs</span><span class="o">**</span><span class="p">(</span><span class="n">KOLMOGORV_CONSTANT</span><span class="p">)</span><span class="o">*</span><span class="n">Kolmogorov_offset</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Kolmogorov -5/3&#39;</span><span class="p">)</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Filter frequency response (cutoff: </span><span class="si">{}</span><span class="s1">Hz) -  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>        <span class="n">filter_func</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fc_Hz&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>        <span class="n">wt_obj</span><span class="o">.</span><span class="n">description</span><span class="p">))</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power Spectrum density [V**2/Hz]&#39;</span><span class="p">)</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>    <span class="c1"># plt.savefig(&#39;Bessel Filter Freq Response.png&#39;)</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a><span class="c1"># %%</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a><span class="c1"># Define a class for FIR operations like</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a><span class="k">def</span> <span class="nf">fir_factory_constructor</span><span class="p">(</span><span class="n">fir_order</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">200</span><span class="p">):</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Mimicing so this is working with Papadakis solution above.</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a><span class="sd">    Description</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a><span class="sd">    -----------</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a><span class="sd">    Now we can use the `.filter()` class method to filter with a simple</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a><span class="sd">    low-pass `FIR`. The idea is to be able to construct tables for standard</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a><span class="sd">    deviation comparison of the methods. This can be also used to define the</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a><span class="sd">    needed fir filter and plot the results with:</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a><span class="sd">      - `plot_comparative_response(wt_obj, filter_func)`</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a><span class="sd">      - wherever we use the `filter_func` keyword to select the filtering</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a><span class="sd">        function.</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a><span class="sd">    Usage</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a><span class="sd">    ------</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a><span class="sd">    ```python</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a><span class="sd">    from pros_noisefiltering.WT_NoiProc import fir_factory_constructor</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a><span class="sd">    fir_200 = fir_factory_constructor(fir_order=60, fc_Hz=200)</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a><span class="sd">    fir_filt_200 = ca1_0.filter(fc_Hz=2_00, filter_func=fir_200).data</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a><span class="sd">    ```</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>    <span class="k">def</span> <span class="nf">fir_filter</span><span class="p">(</span><span class="n">ds</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>                   <span class="n">fs_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>                   <span class="n">fir_filt_order</span><span class="o">=</span><span class="n">fir_order</span><span class="p">):</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>        <span class="n">fir_filt_coeff</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="o">=</span><span class="n">fir_filt_order</span><span class="p">,</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>                                       <span class="n">fs</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">,</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>                                       <span class="n">cutoff</span><span class="o">=</span><span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>                                       <span class="c1"># pass_zero=False ,</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>                                       <span class="c1"># scale= True,</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>                                       <span class="p">)</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>        <span class="c1"># # Hann approach</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>        <span class="c1"># fir_filt_coeff=signal.firwin(fir_order + 1,</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>        <span class="c1">#                              [0, 200/fs_hz],</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>        <span class="c1">#                              fs=fs_hz , window=&#39;hann&#39;)</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>        <span class="c1"># make output sos type to ensure normal operation</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>        <span class="c1"># this is crusial for elimination of ending ripples see image above</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>        <span class="n">sos_fir_mode</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">tf2sos</span><span class="p">(</span><span class="n">fir_filt_coeff</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>        <span class="n">sos_filt_data</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos_fir_mode</span><span class="p">,</span> <span class="n">ds</span><span class="o">-</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>        <span class="c1"># warmup = fir_filt_order-1</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>        <span class="c1"># uncorrupted_output = sos_filt_data[warmup:]</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>        <span class="c1"># filt_sig_time_int = time[warmup:]-((warmup/2)/fs_hz)</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>        <span class="c1"># return uncorrupted_output           # uncorr_sos_output</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>        <span class="k">return</span> <span class="n">sos_filt_data</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>    <span class="c1"># Add the parameter attribute for checking filter response</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>    <span class="n">fir_filter</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;filter order&#39;</span><span class="p">:</span> <span class="n">fir_order</span><span class="p">,</span> <span class="s1">&#39;fc_Hz&#39;</span><span class="p">:</span> <span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>                         <span class="s1">&#39;filter type&#39;</span><span class="p">:</span> <span class="s1">&#39;simple fir&#39;</span><span class="p">}</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>    <span class="k">return</span> <span class="n">fir_filter</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a><span class="n">filter_fir_default</span> <span class="o">=</span> <span class="n">fir_factory_constructor</span><span class="p">(</span><span class="n">fir_order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a><span class="c1"># BUG i.e. replaced by the factory method for fir systems</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a><span class="c1"># class Fir_filter:</span>
</span></pre></div>


            </section>
                <section id="filt_butter_factory">
                            <input id="filt_butter_factory-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filt_butter_factory</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filt_order</span><span class="o">=</span><span class="mi">2</span>, </span><span class="param"><span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="filt_butter_factory-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#filt_butter_factory"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="filt_butter_factory-23"><a href="#filt_butter_factory-23"><span class="linenos">23</span></a><span class="k">def</span> <span class="nf">filt_butter_factory</span><span class="p">(</span><span class="n">filt_order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
</span><span id="filt_butter_factory-24"><a href="#filt_butter_factory-24"><span class="linenos">24</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct a factory method that produces a BUTTERWORTH filter function.</span>
</span><span id="filt_butter_factory-25"><a href="#filt_butter_factory-25"><span class="linenos">25</span></a>
</span><span id="filt_butter_factory-26"><a href="#filt_butter_factory-26"><span class="linenos">26</span></a><span class="sd">    Here we construct a butterworth IIR filter with a filter order and</span>
</span><span id="filt_butter_factory-27"><a href="#filt_butter_factory-27"><span class="linenos">27</span></a><span class="sd">    a cutoff frequency passed as arguments. The function returns a filter using</span>
</span><span id="filt_butter_factory-28"><a href="#filt_butter_factory-28"><span class="linenos">28</span></a><span class="sd">    `scipy.signal` module to generate the it.</span>
</span><span id="filt_butter_factory-29"><a href="#filt_butter_factory-29"><span class="linenos">29</span></a>
</span><span id="filt_butter_factory-30"><a href="#filt_butter_factory-30"><span class="linenos">30</span></a><span class="sd">    Args:</span>
</span><span id="filt_butter_factory-31"><a href="#filt_butter_factory-31"><span class="linenos">31</span></a><span class="sd">    - filt_order (int, optional)  : Filter order. Defaults to 2.</span>
</span><span id="filt_butter_factory-32"><a href="#filt_butter_factory-32"><span class="linenos">32</span></a><span class="sd">    - fc_Hz (float, optional)     : cut off frequency in Hz (defaults to 100)</span>
</span><span id="filt_butter_factory-33"><a href="#filt_butter_factory-33"><span class="linenos">33</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="filt_butter_factory-34"><a href="#filt_butter_factory-34"><span class="linenos">34</span></a>    <span class="k">def</span> <span class="nf">filt_butter</span><span class="p">(</span><span class="n">ds</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="filt_butter_factory-35"><a href="#filt_butter_factory-35"><span class="linenos">35</span></a>                    <span class="n">fs_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="filt_butter_factory-36"><a href="#filt_butter_factory-36"><span class="linenos">36</span></a>                    <span class="n">filt_order</span><span class="o">=</span><span class="n">filt_order</span><span class="p">):</span>
</span><span id="filt_butter_factory-37"><a href="#filt_butter_factory-37"><span class="linenos">37</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply filtering to np.array with fs_Hz data, with cuffoff frequency.</span>
</span><span id="filt_butter_factory-38"><a href="#filt_butter_factory-38"><span class="linenos">38</span></a>
</span><span id="filt_butter_factory-39"><a href="#filt_butter_factory-39"><span class="linenos">39</span></a><span class="sd">        Args:</span>
</span><span id="filt_butter_factory-40"><a href="#filt_butter_factory-40"><span class="linenos">40</span></a><span class="sd">        - ds (np.ndarray): data signal object</span>
</span><span id="filt_butter_factory-41"><a href="#filt_butter_factory-41"><span class="linenos">41</span></a><span class="sd">        - fs_Hz (float): sampling frequency</span>
</span><span id="filt_butter_factory-42"><a href="#filt_butter_factory-42"><span class="linenos">42</span></a><span class="sd">        - fc_Hz (int, optional): cutoff frequency of filter(low pass def:100)</span>
</span><span id="filt_butter_factory-43"><a href="#filt_butter_factory-43"><span class="linenos">43</span></a><span class="sd">        - filt_order (int, optional): The order of the filter (number of</span>
</span><span id="filt_butter_factory-44"><a href="#filt_butter_factory-44"><span class="linenos">44</span></a><span class="sd">        coeff.) to be produced. Defaults to 2. def:2</span>
</span><span id="filt_butter_factory-45"><a href="#filt_butter_factory-45"><span class="linenos">45</span></a>
</span><span id="filt_butter_factory-46"><a href="#filt_butter_factory-46"><span class="linenos">46</span></a><span class="sd">        Returns:</span>
</span><span id="filt_butter_factory-47"><a href="#filt_butter_factory-47"><span class="linenos">47</span></a><span class="sd">        - filtered (signal.sosfilt()): The filter with cutoff and order defined</span>
</span><span id="filt_butter_factory-48"><a href="#filt_butter_factory-48"><span class="linenos">48</span></a><span class="sd">        as arguments</span>
</span><span id="filt_butter_factory-49"><a href="#filt_butter_factory-49"><span class="linenos">49</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="filt_butter_factory-50"><a href="#filt_butter_factory-50"><span class="linenos">50</span></a>        <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">filt_order</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="filt_butter_factory-51"><a href="#filt_butter_factory-51"><span class="linenos">51</span></a>                            <span class="s1">&#39;lp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">,</span>
</span><span id="filt_butter_factory-52"><a href="#filt_butter_factory-52"><span class="linenos">52</span></a>                            <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="filt_butter_factory-53"><a href="#filt_butter_factory-53"><span class="linenos">53</span></a>        <span class="n">filtered</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">ds</span><span class="o">-</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="filt_butter_factory-54"><a href="#filt_butter_factory-54"><span class="linenos">54</span></a>        <span class="k">return</span> <span class="n">filtered</span>
</span><span id="filt_butter_factory-55"><a href="#filt_butter_factory-55"><span class="linenos">55</span></a>    <span class="c1"># additional decoration sith params dictionary</span>
</span><span id="filt_butter_factory-56"><a href="#filt_butter_factory-56"><span class="linenos">56</span></a>    <span class="c1"># this is used instead of a class</span>
</span><span id="filt_butter_factory-57"><a href="#filt_butter_factory-57"><span class="linenos">57</span></a>    <span class="n">filt_butter</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;filter order&#39;</span><span class="p">:</span> <span class="n">filt_order</span><span class="p">,</span> <span class="s1">&#39;fc_Hz&#39;</span><span class="p">:</span> <span class="n">fc_Hz</span><span class="p">}</span>
</span><span id="filt_butter_factory-58"><a href="#filt_butter_factory-58"><span class="linenos">58</span></a>    <span class="k">return</span> <span class="n">filt_butter</span>
</span></pre></div>


            <div class="docstring"><p>Construct a factory method that produces a BUTTERWORTH filter function.</p>

<p>Here we construct a butterworth IIR filter with a filter order and
a cutoff frequency passed as arguments. The function returns a filter using
<code>scipy.signal</code> module to generate the it.</p>

<p>Args:</p>

<ul>
<li>filt_order (int, optional)  : Filter order. Defaults to 2.</li>
<li>fc_Hz (float, optional)     : cut off frequency in Hz (defaults to 100)</li>
</ul>
</div>


                </section>
                <section id="filter_Butter_default">
                            <input id="filter_Butter_default-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_Butter_default</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">ds</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">fs_Hz</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span>, </span><span class="param"><span class="n">filt_order</span><span class="o">=</span><span class="mi">2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="filter_Butter_default-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#filter_Butter_default"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="filter_Butter_default-34"><a href="#filter_Butter_default-34"><span class="linenos">34</span></a>    <span class="k">def</span> <span class="nf">filt_butter</span><span class="p">(</span><span class="n">ds</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="filter_Butter_default-35"><a href="#filter_Butter_default-35"><span class="linenos">35</span></a>                    <span class="n">fs_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="filter_Butter_default-36"><a href="#filter_Butter_default-36"><span class="linenos">36</span></a>                    <span class="n">filt_order</span><span class="o">=</span><span class="n">filt_order</span><span class="p">):</span>
</span><span id="filter_Butter_default-37"><a href="#filter_Butter_default-37"><span class="linenos">37</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply filtering to np.array with fs_Hz data, with cuffoff frequency.</span>
</span><span id="filter_Butter_default-38"><a href="#filter_Butter_default-38"><span class="linenos">38</span></a>
</span><span id="filter_Butter_default-39"><a href="#filter_Butter_default-39"><span class="linenos">39</span></a><span class="sd">        Args:</span>
</span><span id="filter_Butter_default-40"><a href="#filter_Butter_default-40"><span class="linenos">40</span></a><span class="sd">        - ds (np.ndarray): data signal object</span>
</span><span id="filter_Butter_default-41"><a href="#filter_Butter_default-41"><span class="linenos">41</span></a><span class="sd">        - fs_Hz (float): sampling frequency</span>
</span><span id="filter_Butter_default-42"><a href="#filter_Butter_default-42"><span class="linenos">42</span></a><span class="sd">        - fc_Hz (int, optional): cutoff frequency of filter(low pass def:100)</span>
</span><span id="filter_Butter_default-43"><a href="#filter_Butter_default-43"><span class="linenos">43</span></a><span class="sd">        - filt_order (int, optional): The order of the filter (number of</span>
</span><span id="filter_Butter_default-44"><a href="#filter_Butter_default-44"><span class="linenos">44</span></a><span class="sd">        coeff.) to be produced. Defaults to 2. def:2</span>
</span><span id="filter_Butter_default-45"><a href="#filter_Butter_default-45"><span class="linenos">45</span></a>
</span><span id="filter_Butter_default-46"><a href="#filter_Butter_default-46"><span class="linenos">46</span></a><span class="sd">        Returns:</span>
</span><span id="filter_Butter_default-47"><a href="#filter_Butter_default-47"><span class="linenos">47</span></a><span class="sd">        - filtered (signal.sosfilt()): The filter with cutoff and order defined</span>
</span><span id="filter_Butter_default-48"><a href="#filter_Butter_default-48"><span class="linenos">48</span></a><span class="sd">        as arguments</span>
</span><span id="filter_Butter_default-49"><a href="#filter_Butter_default-49"><span class="linenos">49</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="filter_Butter_default-50"><a href="#filter_Butter_default-50"><span class="linenos">50</span></a>        <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">filt_order</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="filter_Butter_default-51"><a href="#filter_Butter_default-51"><span class="linenos">51</span></a>                            <span class="s1">&#39;lp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">,</span>
</span><span id="filter_Butter_default-52"><a href="#filter_Butter_default-52"><span class="linenos">52</span></a>                            <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="filter_Butter_default-53"><a href="#filter_Butter_default-53"><span class="linenos">53</span></a>        <span class="n">filtered</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">ds</span><span class="o">-</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="filter_Butter_default-54"><a href="#filter_Butter_default-54"><span class="linenos">54</span></a>        <span class="k">return</span> <span class="n">filtered</span>
</span></pre></div>


            <div class="docstring"><p>Apply filtering to np.array with fs_Hz data, with cuffoff frequency.</p>

<p>Args:</p>

<ul>
<li>ds (np.ndarray): data signal object</li>
<li>fs_Hz (float): sampling frequency</li>
<li>fc_Hz (int, optional): cutoff frequency of filter(low pass def:100)</li>
<li>filt_order (int, optional): The order of the filter (number of
coeff.) to be produced. Defaults to 2. def:2</li>
</ul>

<p>Returns:</p>

<ul>
<li>filtered (signal.sosfilt()): The filter with cutoff and order defined
as arguments</li>
</ul>
</div>


                </section>
                <section id="WT_NoiseChannelProc">
                            <input id="WT_NoiseChannelProc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">WT_NoiseChannelProc</span>:

                <label class="view-source-button" for="WT_NoiseChannelProc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WT_NoiseChannelProc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WT_NoiseChannelProc-64"><a href="#WT_NoiseChannelProc-64"><span class="linenos"> 64</span></a><span class="k">class</span> <span class="nc">WT_NoiseChannelProc</span><span class="p">():</span>
</span><span id="WT_NoiseChannelProc-65"><a href="#WT_NoiseChannelProc-65"><span class="linenos"> 65</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for processing a tdms file for noise processing.&quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-66"><a href="#WT_NoiseChannelProc-66"><span class="linenos"> 66</span></a>
</span><span id="WT_NoiseChannelProc-67"><a href="#WT_NoiseChannelProc-67"><span class="linenos"> 67</span></a>    <span class="n">__measurement_history</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="WT_NoiseChannelProc-68"><a href="#WT_NoiseChannelProc-68"><span class="linenos"> 68</span></a>
</span><span id="WT_NoiseChannelProc-69"><a href="#WT_NoiseChannelProc-69"><span class="linenos"> 69</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-70"><a href="#WT_NoiseChannelProc-70"><span class="linenos"> 70</span></a>                 <span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">group_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">_channel_data</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-71"><a href="#WT_NoiseChannelProc-71"><span class="linenos"> 71</span></a>                 <span class="n">operations</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc-72"><a href="#WT_NoiseChannelProc-72"><span class="linenos"> 72</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize constructor for managing tdms files.&quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-73"><a href="#WT_NoiseChannelProc-73"><span class="linenos"> 73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_channel_data</span> <span class="o">=</span> <span class="n">_channel_data</span>
</span><span id="WT_NoiseChannelProc-74"><a href="#WT_NoiseChannelProc-74"><span class="linenos"> 74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-75"><a href="#WT_NoiseChannelProc-75"><span class="linenos"> 75</span></a>        <span class="c1"># process details</span>
</span><span id="WT_NoiseChannelProc-76"><a href="#WT_NoiseChannelProc-76"><span class="linenos"> 76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span> <span class="o">=</span> <span class="n">fs_Hz</span>
</span><span id="WT_NoiseChannelProc-77"><a href="#WT_NoiseChannelProc-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="WT_NoiseChannelProc-78"><a href="#WT_NoiseChannelProc-78"><span class="linenos"> 78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">channel_name</span> <span class="o">=</span> <span class="n">channel_name</span>
</span><span id="WT_NoiseChannelProc-79"><a href="#WT_NoiseChannelProc-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">group_name</span> <span class="o">=</span> <span class="n">group_name</span>
</span><span id="WT_NoiseChannelProc-80"><a href="#WT_NoiseChannelProc-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__measurement_history</span> <span class="o">=</span> <span class="n">operations</span>
</span><span id="WT_NoiseChannelProc-81"><a href="#WT_NoiseChannelProc-81"><span class="linenos"> 81</span></a>
</span><span id="WT_NoiseChannelProc-82"><a href="#WT_NoiseChannelProc-82"><span class="linenos"> 82</span></a>    <span class="k">def</span> <span class="nf">set_description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc-83"><a href="#WT_NoiseChannelProc-83"><span class="linenos"> 83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the description of the file.</span>
</span><span id="WT_NoiseChannelProc-84"><a href="#WT_NoiseChannelProc-84"><span class="linenos"> 84</span></a>
</span><span id="WT_NoiseChannelProc-85"><a href="#WT_NoiseChannelProc-85"><span class="linenos"> 85</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc-86"><a href="#WT_NoiseChannelProc-86"><span class="linenos"> 86</span></a><span class="sd">            desc (_type_): _description_</span>
</span><span id="WT_NoiseChannelProc-87"><a href="#WT_NoiseChannelProc-87"><span class="linenos"> 87</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-88"><a href="#WT_NoiseChannelProc-88"><span class="linenos"> 88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">desc</span>
</span><span id="WT_NoiseChannelProc-89"><a href="#WT_NoiseChannelProc-89"><span class="linenos"> 89</span></a>
</span><span id="WT_NoiseChannelProc-90"><a href="#WT_NoiseChannelProc-90"><span class="linenos"> 90</span></a>    <span class="nd">@property</span>
</span><span id="WT_NoiseChannelProc-91"><a href="#WT_NoiseChannelProc-91"><span class="linenos"> 91</span></a>    <span class="k">def</span> <span class="nf">operations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc-92"><a href="#WT_NoiseChannelProc-92"><span class="linenos"> 92</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Capture operations on data.&quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-93"><a href="#WT_NoiseChannelProc-93"><span class="linenos"> 93</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__measurement_history</span>
</span><span id="WT_NoiseChannelProc-94"><a href="#WT_NoiseChannelProc-94"><span class="linenos"> 94</span></a>
</span><span id="WT_NoiseChannelProc-95"><a href="#WT_NoiseChannelProc-95"><span class="linenos"> 95</span></a>    <span class="nd">@property</span>
</span><span id="WT_NoiseChannelProc-96"><a href="#WT_NoiseChannelProc-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="nf">data_as_Series</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="WT_NoiseChannelProc-97"><a href="#WT_NoiseChannelProc-97"><span class="linenos"> 97</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the raw data as a pd.Series.</span>
</span><span id="WT_NoiseChannelProc-98"><a href="#WT_NoiseChannelProc-98"><span class="linenos"> 98</span></a>
</span><span id="WT_NoiseChannelProc-99"><a href="#WT_NoiseChannelProc-99"><span class="linenos"> 99</span></a><span class="sd">        Returns:</span>
</span><span id="WT_NoiseChannelProc-100"><a href="#WT_NoiseChannelProc-100"><span class="linenos">100</span></a><span class="sd">            _type_: _description_</span>
</span><span id="WT_NoiseChannelProc-101"><a href="#WT_NoiseChannelProc-101"><span class="linenos">101</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-102"><a href="#WT_NoiseChannelProc-102"><span class="linenos">102</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name</span><span class="si">}</span><span class="s1">:raw&#39;</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-103"><a href="#WT_NoiseChannelProc-103"><span class="linenos">103</span></a>
</span><span id="WT_NoiseChannelProc-104"><a href="#WT_NoiseChannelProc-104"><span class="linenos">104</span></a>    <span class="k">def</span> <span class="nf">average</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fr_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc-105"><a href="#WT_NoiseChannelProc-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return another object.</span>
</span><span id="WT_NoiseChannelProc-106"><a href="#WT_NoiseChannelProc-106"><span class="linenos">106</span></a>
</span><span id="WT_NoiseChannelProc-107"><a href="#WT_NoiseChannelProc-107"><span class="linenos">107</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc-108"><a href="#WT_NoiseChannelProc-108"><span class="linenos">108</span></a><span class="sd">        - fr_Hz (float) : recording frequency (with averaging)</span>
</span><span id="WT_NoiseChannelProc-109"><a href="#WT_NoiseChannelProc-109"><span class="linenos">109</span></a><span class="sd">        - desc (str) : description</span>
</span><span id="WT_NoiseChannelProc-110"><a href="#WT_NoiseChannelProc-110"><span class="linenos">110</span></a><span class="sd">            - Defaults to None: ie. add suffix _Av:&lt;fr_Hz&gt;)</span>
</span><span id="WT_NoiseChannelProc-111"><a href="#WT_NoiseChannelProc-111"><span class="linenos">111</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-112"><a href="#WT_NoiseChannelProc-112"><span class="linenos">112</span></a>        <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_as_Series</span>
</span><span id="WT_NoiseChannelProc-113"><a href="#WT_NoiseChannelProc-113"><span class="linenos">113</span></a>        <span class="n">fs_Hz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span>
</span><span id="WT_NoiseChannelProc-114"><a href="#WT_NoiseChannelProc-114"><span class="linenos">114</span></a>
</span><span id="WT_NoiseChannelProc-115"><a href="#WT_NoiseChannelProc-115"><span class="linenos">115</span></a>        <span class="n">ds_fr</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="p">(</span><span class="n">fs_Hz</span> <span class="o">/</span> <span class="n">fr_Hz</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</span><span id="WT_NoiseChannelProc-116"><a href="#WT_NoiseChannelProc-116"><span class="linenos">116</span></a>
</span><span id="WT_NoiseChannelProc-117"><a href="#WT_NoiseChannelProc-117"><span class="linenos">117</span></a>        <span class="n">description</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="WT_NoiseChannelProc-118"><a href="#WT_NoiseChannelProc-118"><span class="linenos">118</span></a>            <span class="n">desc</span> <span class="k">if</span> <span class="n">desc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;_Av:</span><span class="si">{</span><span class="n">fr_Hz</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-119"><a href="#WT_NoiseChannelProc-119"><span class="linenos">119</span></a>        <span class="c1"># TODO need to think better the naming conventions</span>
</span><span id="WT_NoiseChannelProc-120"><a href="#WT_NoiseChannelProc-120"><span class="linenos">120</span></a>        <span class="c1"># (consider using a dictionary with multiple keys</span>
</span><span id="WT_NoiseChannelProc-121"><a href="#WT_NoiseChannelProc-121"><span class="linenos">121</span></a>        <span class="c1"># e.g. different for plots etc)</span>
</span><span id="WT_NoiseChannelProc-122"><a href="#WT_NoiseChannelProc-122"><span class="linenos">122</span></a>        <span class="n">new_operations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="WT_NoiseChannelProc-123"><a href="#WT_NoiseChannelProc-123"><span class="linenos">123</span></a>        <span class="n">new_operations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Apply Averaging :</span><span class="si">{</span><span class="n">fr_Hz</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-124"><a href="#WT_NoiseChannelProc-124"><span class="linenos">124</span></a>
</span><span id="WT_NoiseChannelProc-125"><a href="#WT_NoiseChannelProc-125"><span class="linenos">125</span></a>        <span class="k">return</span> <span class="n">WT_NoiseChannelProc</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-126"><a href="#WT_NoiseChannelProc-126"><span class="linenos">126</span></a>                                   <span class="n">fs_Hz</span><span class="o">=</span><span class="n">fr_Hz</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ds_fr</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-127"><a href="#WT_NoiseChannelProc-127"><span class="linenos">127</span></a>                                   <span class="n">channel_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-128"><a href="#WT_NoiseChannelProc-128"><span class="linenos">128</span></a>                                   <span class="n">group_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">group_name</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-129"><a href="#WT_NoiseChannelProc-129"><span class="linenos">129</span></a>                                   <span class="n">_channel_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-130"><a href="#WT_NoiseChannelProc-130"><span class="linenos">130</span></a>                                   <span class="n">operations</span><span class="o">=</span><span class="n">new_operations</span>
</span><span id="WT_NoiseChannelProc-131"><a href="#WT_NoiseChannelProc-131"><span class="linenos">131</span></a>                                   <span class="p">)</span>
</span><span id="WT_NoiseChannelProc-132"><a href="#WT_NoiseChannelProc-132"><span class="linenos">132</span></a>
</span><span id="WT_NoiseChannelProc-133"><a href="#WT_NoiseChannelProc-133"><span class="linenos">133</span></a>    <span class="k">def</span> <span class="nf">set_desc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc-134"><a href="#WT_NoiseChannelProc-134"><span class="linenos">134</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set description for any operation or info for the data object.&quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-135"><a href="#WT_NoiseChannelProc-135"><span class="linenos">135</span></a>        <span class="k">return</span> <span class="n">WT_NoiseChannelProc</span><span class="o">.</span><span class="n">from_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-136"><a href="#WT_NoiseChannelProc-136"><span class="linenos">136</span></a>                                            <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-137"><a href="#WT_NoiseChannelProc-137"><span class="linenos">137</span></a>
</span><span id="WT_NoiseChannelProc-138"><a href="#WT_NoiseChannelProc-138"><span class="linenos">138</span></a>    <span class="k">def</span> <span class="nf">decimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dec</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc-139"><a href="#WT_NoiseChannelProc-139"><span class="linenos">139</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a decimated data seires.</span>
</span><span id="WT_NoiseChannelProc-140"><a href="#WT_NoiseChannelProc-140"><span class="linenos">140</span></a>
</span><span id="WT_NoiseChannelProc-141"><a href="#WT_NoiseChannelProc-141"><span class="linenos">141</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc-142"><a href="#WT_NoiseChannelProc-142"><span class="linenos">142</span></a><span class="sd">        - dec (int): decimation factor</span>
</span><span id="WT_NoiseChannelProc-143"><a href="#WT_NoiseChannelProc-143"><span class="linenos">143</span></a><span class="sd">        - offset (int): initial offset</span>
</span><span id="WT_NoiseChannelProc-144"><a href="#WT_NoiseChannelProc-144"><span class="linenos">144</span></a>
</span><span id="WT_NoiseChannelProc-145"><a href="#WT_NoiseChannelProc-145"><span class="linenos">145</span></a><span class="sd">        Returns:</span>
</span><span id="WT_NoiseChannelProc-146"><a href="#WT_NoiseChannelProc-146"><span class="linenos">146</span></a><span class="sd">        - WT_NoiseChannelProc.obj: a decimated data series.</span>
</span><span id="WT_NoiseChannelProc-147"><a href="#WT_NoiseChannelProc-147"><span class="linenos">147</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-148"><a href="#WT_NoiseChannelProc-148"><span class="linenos">148</span></a>        <span class="n">decimated_fs_Hz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span><span class="o">/</span><span class="n">dec</span>
</span><span id="WT_NoiseChannelProc-149"><a href="#WT_NoiseChannelProc-149"><span class="linenos">149</span></a>
</span><span id="WT_NoiseChannelProc-150"><a href="#WT_NoiseChannelProc-150"><span class="linenos">150</span></a>        <span class="n">new_operation</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="WT_NoiseChannelProc-151"><a href="#WT_NoiseChannelProc-151"><span class="linenos">151</span></a>            <span class="sa">f</span><span class="s1">&#39;Decimation factor:</span><span class="si">{</span><span class="n">dec</span><span class="si">}</span><span class="s1">, Offset:</span><span class="si">{</span><span class="n">offset</span><span class="si">}</span><span class="s1">, new fs_Hz:</span><span class="si">{</span><span class="n">decimated_fs_Hz</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-152"><a href="#WT_NoiseChannelProc-152"><span class="linenos">152</span></a>
</span><span id="WT_NoiseChannelProc-153"><a href="#WT_NoiseChannelProc-153"><span class="linenos">153</span></a>        <span class="k">return</span> <span class="n">WT_NoiseChannelProc</span><span class="o">.</span><span class="n">from_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-154"><a href="#WT_NoiseChannelProc-154"><span class="linenos">154</span></a>                                            <span class="n">operation</span><span class="o">=</span><span class="n">new_operation</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-155"><a href="#WT_NoiseChannelProc-155"><span class="linenos">155</span></a>                                            <span class="n">fs_Hz</span><span class="o">=</span><span class="n">decimated_fs_Hz</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-156"><a href="#WT_NoiseChannelProc-156"><span class="linenos">156</span></a>                                            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">offset</span><span class="p">::</span><span class="n">dec</span><span class="p">])</span>
</span><span id="WT_NoiseChannelProc-157"><a href="#WT_NoiseChannelProc-157"><span class="linenos">157</span></a>
</span><span id="WT_NoiseChannelProc-158"><a href="#WT_NoiseChannelProc-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-159"><a href="#WT_NoiseChannelProc-159"><span class="linenos">159</span></a>                <span class="n">filter_func</span><span class="o">=</span><span class="n">filter_Butter_default</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-160"><a href="#WT_NoiseChannelProc-160"><span class="linenos">160</span></a>                <span class="n">fs_Hz</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="WT_NoiseChannelProc-161"><a href="#WT_NoiseChannelProc-161"><span class="linenos">161</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a filtered signal based on.</span>
</span><span id="WT_NoiseChannelProc-162"><a href="#WT_NoiseChannelProc-162"><span class="linenos">162</span></a>
</span><span id="WT_NoiseChannelProc-163"><a href="#WT_NoiseChannelProc-163"><span class="linenos">163</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc-164"><a href="#WT_NoiseChannelProc-164"><span class="linenos">164</span></a><span class="sd">            fc_Hz (float): cut off frequency in Hz</span>
</span><span id="WT_NoiseChannelProc-165"><a href="#WT_NoiseChannelProc-165"><span class="linenos">165</span></a><span class="sd">            filter_func (filt_butter_factory, optional): filtering function</span>
</span><span id="WT_NoiseChannelProc-166"><a href="#WT_NoiseChannelProc-166"><span class="linenos">166</span></a><span class="sd">                        that thates two arguments (ds, fs_Hz).</span>
</span><span id="WT_NoiseChannelProc-167"><a href="#WT_NoiseChannelProc-167"><span class="linenos">167</span></a><span class="sd">                        Defaults to 100, filt_order = 2).</span>
</span><span id="WT_NoiseChannelProc-168"><a href="#WT_NoiseChannelProc-168"><span class="linenos">168</span></a><span class="sd">            fs_Hz (None): sampling frequency in Hz (#TODO SHOULD BE REMOVED)</span>
</span><span id="WT_NoiseChannelProc-169"><a href="#WT_NoiseChannelProc-169"><span class="linenos">169</span></a>
</span><span id="WT_NoiseChannelProc-170"><a href="#WT_NoiseChannelProc-170"><span class="linenos">170</span></a>
</span><span id="WT_NoiseChannelProc-171"><a href="#WT_NoiseChannelProc-171"><span class="linenos">171</span></a><span class="sd">        Returns:</span>
</span><span id="WT_NoiseChannelProc-172"><a href="#WT_NoiseChannelProc-172"><span class="linenos">172</span></a><span class="sd">            _type_: _description_</span>
</span><span id="WT_NoiseChannelProc-173"><a href="#WT_NoiseChannelProc-173"><span class="linenos">173</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-174"><a href="#WT_NoiseChannelProc-174"><span class="linenos">174</span></a>        <span class="k">if</span> <span class="n">fs_Hz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="WT_NoiseChannelProc-175"><a href="#WT_NoiseChannelProc-175"><span class="linenos">175</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="WT_NoiseChannelProc-176"><a href="#WT_NoiseChannelProc-176"><span class="linenos">176</span></a>                <span class="sa">f</span><span class="s1">&#39;issued </span><span class="si">{</span><span class="n">fs_Hz</span><span class="si">}</span><span class="s1"> sampling frequency while the default is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-177"><a href="#WT_NoiseChannelProc-177"><span class="linenos">177</span></a>        <span class="n">fs_Hz</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="WT_NoiseChannelProc-178"><a href="#WT_NoiseChannelProc-178"><span class="linenos">178</span></a>            <span class="n">fs_Hz</span> <span class="k">if</span> <span class="n">fs_Hz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-179"><a href="#WT_NoiseChannelProc-179"><span class="linenos">179</span></a>
</span><span id="WT_NoiseChannelProc-180"><a href="#WT_NoiseChannelProc-180"><span class="linenos">180</span></a>        <span class="n">filtered</span> <span class="o">=</span> <span class="n">filter_func</span><span class="p">(</span><span class="n">ds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-181"><a href="#WT_NoiseChannelProc-181"><span class="linenos">181</span></a>                               <span class="n">fs_Hz</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-182"><a href="#WT_NoiseChannelProc-182"><span class="linenos">182</span></a>                               <span class="n">fc_Hz</span><span class="o">=</span><span class="n">fc_Hz</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-183"><a href="#WT_NoiseChannelProc-183"><span class="linenos">183</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-184"><a href="#WT_NoiseChannelProc-184"><span class="linenos">184</span></a>                         <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name</span><span class="si">}</span><span class="s1">:filt_fc_</span><span class="si">{</span><span class="n">fc_Hz</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-185"><a href="#WT_NoiseChannelProc-185"><span class="linenos">185</span></a>
</span><span id="WT_NoiseChannelProc-186"><a href="#WT_NoiseChannelProc-186"><span class="linenos">186</span></a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-187"><a href="#WT_NoiseChannelProc-187"><span class="linenos">187</span></a>               <span class="n">filter_func</span><span class="o">=</span><span class="n">filter_Butter_default</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-188"><a href="#WT_NoiseChannelProc-188"><span class="linenos">188</span></a>               <span class="n">fs_Hz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc-189"><a href="#WT_NoiseChannelProc-189"><span class="linenos">189</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter a signal with the chosen factory method (IIR, FIR).&quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-190"><a href="#WT_NoiseChannelProc-190"><span class="linenos">190</span></a>        <span class="n">ds_filt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter</span><span class="p">(</span><span class="n">fc_Hz</span><span class="o">=</span><span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-191"><a href="#WT_NoiseChannelProc-191"><span class="linenos">191</span></a>                               <span class="n">filter_func</span><span class="o">=</span><span class="n">filter_func</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-192"><a href="#WT_NoiseChannelProc-192"><span class="linenos">192</span></a>                               <span class="n">fs_Hz</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-193"><a href="#WT_NoiseChannelProc-193"><span class="linenos">193</span></a>        <span class="c1"># description = (</span>
</span><span id="WT_NoiseChannelProc-194"><a href="#WT_NoiseChannelProc-194"><span class="linenos">194</span></a>        <span class="c1">#     desc if desc is not None else self.description + f&quot;_fc:{fc_Hz}&quot;)</span>
</span><span id="WT_NoiseChannelProc-195"><a href="#WT_NoiseChannelProc-195"><span class="linenos">195</span></a>        <span class="k">return</span> <span class="n">WT_NoiseChannelProc</span><span class="o">.</span><span class="n">from_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-196"><a href="#WT_NoiseChannelProc-196"><span class="linenos">196</span></a>                                            <span class="n">data</span><span class="o">=</span><span class="n">ds_filt</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-197"><a href="#WT_NoiseChannelProc-197"><span class="linenos">197</span></a>                                            <span class="n">operation</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;pass filter </span><span class="si">{</span><span class="n">fc_Hz</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="WT_NoiseChannelProc-198"><a href="#WT_NoiseChannelProc-198"><span class="linenos">198</span></a>                                            <span class="p">)</span>
</span><span id="WT_NoiseChannelProc-199"><a href="#WT_NoiseChannelProc-199"><span class="linenos">199</span></a>
</span><span id="WT_NoiseChannelProc-200"><a href="#WT_NoiseChannelProc-200"><span class="linenos">200</span></a>    <span class="k">def</span> <span class="nf">calc_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-201"><a href="#WT_NoiseChannelProc-201"><span class="linenos">201</span></a>                      <span class="n">window</span><span class="o">=</span><span class="s1">&#39;flattop&#39;</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">1_024</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-202"><a href="#WT_NoiseChannelProc-202"><span class="linenos">202</span></a>                      <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graph_data_container</span><span class="p">:</span>
</span><span id="WT_NoiseChannelProc-203"><a href="#WT_NoiseChannelProc-203"><span class="linenos">203</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Graph_data_container object.</span>
</span><span id="WT_NoiseChannelProc-204"><a href="#WT_NoiseChannelProc-204"><span class="linenos">204</span></a>
</span><span id="WT_NoiseChannelProc-205"><a href="#WT_NoiseChannelProc-205"><span class="linenos">205</span></a><span class="sd">        with:</span>
</span><span id="WT_NoiseChannelProc-206"><a href="#WT_NoiseChannelProc-206"><span class="linenos">206</span></a><span class="sd">        - the power spectrum of the data.</span>
</span><span id="WT_NoiseChannelProc-207"><a href="#WT_NoiseChannelProc-207"><span class="linenos">207</span></a><span class="sd">        - uses the decimation function</span>
</span><span id="WT_NoiseChannelProc-208"><a href="#WT_NoiseChannelProc-208"><span class="linenos">208</span></a>
</span><span id="WT_NoiseChannelProc-209"><a href="#WT_NoiseChannelProc-209"><span class="linenos">209</span></a><span class="sd">        Returns:</span>
</span><span id="WT_NoiseChannelProc-210"><a href="#WT_NoiseChannelProc-210"><span class="linenos">210</span></a><span class="sd">        - classmethod: Graph_data_container</span>
</span><span id="WT_NoiseChannelProc-211"><a href="#WT_NoiseChannelProc-211"><span class="linenos">211</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-212"><a href="#WT_NoiseChannelProc-212"><span class="linenos">212</span></a>        <span class="n">gobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_spectrum_gen</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-213"><a href="#WT_NoiseChannelProc-213"><span class="linenos">213</span></a>                                      <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="n">scaling</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-214"><a href="#WT_NoiseChannelProc-214"><span class="linenos">214</span></a>        <span class="k">return</span> <span class="n">gobj</span>
</span><span id="WT_NoiseChannelProc-215"><a href="#WT_NoiseChannelProc-215"><span class="linenos">215</span></a>
</span><span id="WT_NoiseChannelProc-216"><a href="#WT_NoiseChannelProc-216"><span class="linenos">216</span></a>    <span class="k">def</span> <span class="nf">calc_spectrum_gen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dec</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-217"><a href="#WT_NoiseChannelProc-217"><span class="linenos">217</span></a>                          <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-218"><a href="#WT_NoiseChannelProc-218"><span class="linenos">218</span></a>                          <span class="n">window</span><span class="o">=</span><span class="s1">&#39;flattop&#39;</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-219"><a href="#WT_NoiseChannelProc-219"><span class="linenos">219</span></a>                          <span class="n">nperseg</span><span class="o">=</span><span class="mi">1_024</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-220"><a href="#WT_NoiseChannelProc-220"><span class="linenos">220</span></a>                          <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graph_data_container</span><span class="p">:</span>
</span><span id="WT_NoiseChannelProc-221"><a href="#WT_NoiseChannelProc-221"><span class="linenos">221</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create function for calculating the spectrum of a time series.</span>
</span><span id="WT_NoiseChannelProc-222"><a href="#WT_NoiseChannelProc-222"><span class="linenos">222</span></a>
</span><span id="WT_NoiseChannelProc-223"><a href="#WT_NoiseChannelProc-223"><span class="linenos">223</span></a><span class="sd">        Return a Graph_data_container object with the power spectrum</span>
</span><span id="WT_NoiseChannelProc-224"><a href="#WT_NoiseChannelProc-224"><span class="linenos">224</span></a><span class="sd">        of the **decimated** data.</span>
</span><span id="WT_NoiseChannelProc-225"><a href="#WT_NoiseChannelProc-225"><span class="linenos">225</span></a>
</span><span id="WT_NoiseChannelProc-226"><a href="#WT_NoiseChannelProc-226"><span class="linenos">226</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc-227"><a href="#WT_NoiseChannelProc-227"><span class="linenos">227</span></a><span class="sd">        - dec (int): decimation factor</span>
</span><span id="WT_NoiseChannelProc-228"><a href="#WT_NoiseChannelProc-228"><span class="linenos">228</span></a><span class="sd">        - offset (int, optional): offset.</span>
</span><span id="WT_NoiseChannelProc-229"><a href="#WT_NoiseChannelProc-229"><span class="linenos">229</span></a><span class="sd">            - Defaults to 0.</span>
</span><span id="WT_NoiseChannelProc-230"><a href="#WT_NoiseChannelProc-230"><span class="linenos">230</span></a>
</span><span id="WT_NoiseChannelProc-231"><a href="#WT_NoiseChannelProc-231"><span class="linenos">231</span></a><span class="sd">        Returns:</span>
</span><span id="WT_NoiseChannelProc-232"><a href="#WT_NoiseChannelProc-232"><span class="linenos">232</span></a><span class="sd">        - Graph_data_container: Containing the spectral density of the given</span>
</span><span id="WT_NoiseChannelProc-233"><a href="#WT_NoiseChannelProc-233"><span class="linenos">233</span></a><span class="sd">        signal.</span>
</span><span id="WT_NoiseChannelProc-234"><a href="#WT_NoiseChannelProc-234"><span class="linenos">234</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-235"><a href="#WT_NoiseChannelProc-235"><span class="linenos">235</span></a>        <span class="n">decimated_fs_Hz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span><span class="o">/</span><span class="n">dec</span>
</span><span id="WT_NoiseChannelProc-236"><a href="#WT_NoiseChannelProc-236"><span class="linenos">236</span></a>        <span class="n">x_r</span><span class="p">,</span> <span class="n">y_r</span> <span class="o">=</span> <span class="n">spect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">offset</span><span class="p">::</span><span class="n">dec</span><span class="p">],</span>
</span><span id="WT_NoiseChannelProc-237"><a href="#WT_NoiseChannelProc-237"><span class="linenos">237</span></a>                         <span class="n">FS</span><span class="o">=</span><span class="n">decimated_fs_Hz</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-238"><a href="#WT_NoiseChannelProc-238"><span class="linenos">238</span></a>                         <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-239"><a href="#WT_NoiseChannelProc-239"><span class="linenos">239</span></a>                         <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-240"><a href="#WT_NoiseChannelProc-240"><span class="linenos">240</span></a>                         <span class="n">scaling</span><span class="o">=</span><span class="n">scaling</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-241"><a href="#WT_NoiseChannelProc-241"><span class="linenos">241</span></a>        <span class="k">if</span> <span class="n">dec</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="WT_NoiseChannelProc-242"><a href="#WT_NoiseChannelProc-242"><span class="linenos">242</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="WT_NoiseChannelProc-243"><a href="#WT_NoiseChannelProc-243"><span class="linenos">243</span></a>            <span class="c1"># TODO the new chain method approach does not require this.</span>
</span><span id="WT_NoiseChannelProc-244"><a href="#WT_NoiseChannelProc-244"><span class="linenos">244</span></a>            <span class="c1"># This is a remnant from the original approach.</span>
</span><span id="WT_NoiseChannelProc-245"><a href="#WT_NoiseChannelProc-245"><span class="linenos">245</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="WT_NoiseChannelProc-246"><a href="#WT_NoiseChannelProc-246"><span class="linenos">246</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="WT_NoiseChannelProc-247"><a href="#WT_NoiseChannelProc-247"><span class="linenos">247</span></a>                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name</span><span class="si">}</span><span class="s1">-fs:</span><span class="si">{</span><span class="n">decimated_fs_Hz</span><span class="o">/</span><span class="mi">1000</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">kHz &#39;</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-248"><a href="#WT_NoiseChannelProc-248"><span class="linenos">248</span></a>
</span><span id="WT_NoiseChannelProc-249"><a href="#WT_NoiseChannelProc-249"><span class="linenos">249</span></a>        <span class="k">return</span> <span class="n">Graph_data_container</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_r</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_r</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-250"><a href="#WT_NoiseChannelProc-250"><span class="linenos">250</span></a>                                    <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-251"><a href="#WT_NoiseChannelProc-251"><span class="linenos">251</span></a>
</span><span id="WT_NoiseChannelProc-252"><a href="#WT_NoiseChannelProc-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">plot_filtered_th</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_func</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc-253"><a href="#WT_NoiseChannelProc-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the Time History.</span>
</span><span id="WT_NoiseChannelProc-254"><a href="#WT_NoiseChannelProc-254"><span class="linenos">254</span></a>
</span><span id="WT_NoiseChannelProc-255"><a href="#WT_NoiseChannelProc-255"><span class="linenos">255</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc-256"><a href="#WT_NoiseChannelProc-256"><span class="linenos">256</span></a><span class="sd">        - filter_func (factory method): Choose the wanted filter</span>
</span><span id="WT_NoiseChannelProc-257"><a href="#WT_NoiseChannelProc-257"><span class="linenos">257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-258"><a href="#WT_NoiseChannelProc-258"><span class="linenos">258</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-259"><a href="#WT_NoiseChannelProc-259"><span class="linenos">259</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">filter_func</span><span class="o">=</span><span class="n">filter_func</span><span class="p">),</span>
</span><span id="WT_NoiseChannelProc-260"><a href="#WT_NoiseChannelProc-260"><span class="linenos">260</span></a>                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;filtered: </span><span class="si">{</span><span class="n">filter_func</span><span class="o">.</span><span class="n">params</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-261"><a href="#WT_NoiseChannelProc-261"><span class="linenos">261</span></a>
</span><span id="WT_NoiseChannelProc-262"><a href="#WT_NoiseChannelProc-262"><span class="linenos">262</span></a>    <span class="nd">@classmethod</span>
</span><span id="WT_NoiseChannelProc-263"><a href="#WT_NoiseChannelProc-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">from_tdms</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">tdms_channel</span><span class="p">:</span> <span class="n">nptdms</span><span class="o">.</span><span class="n">tdms</span><span class="o">.</span><span class="n">TdmsChannel</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc-264"><a href="#WT_NoiseChannelProc-264"><span class="linenos">264</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;## Initiate factory method that generates an object class.</span>
</span><span id="WT_NoiseChannelProc-265"><a href="#WT_NoiseChannelProc-265"><span class="linenos">265</span></a>
</span><span id="WT_NoiseChannelProc-266"><a href="#WT_NoiseChannelProc-266"><span class="linenos">266</span></a><span class="sd">        #### TOD need to change the init function and test.</span>
</span><span id="WT_NoiseChannelProc-267"><a href="#WT_NoiseChannelProc-267"><span class="linenos">267</span></a>
</span><span id="WT_NoiseChannelProc-268"><a href="#WT_NoiseChannelProc-268"><span class="linenos">268</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc-269"><a href="#WT_NoiseChannelProc-269"><span class="linenos">269</span></a><span class="sd">        - tdms_channel (nptdms.tdms.TdmsChannel): tmds channel name</span>
</span><span id="WT_NoiseChannelProc-270"><a href="#WT_NoiseChannelProc-270"><span class="linenos">270</span></a><span class="sd">        - desc (str): descirption (used)</span>
</span><span id="WT_NoiseChannelProc-271"><a href="#WT_NoiseChannelProc-271"><span class="linenos">271</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-272"><a href="#WT_NoiseChannelProc-272"><span class="linenos">272</span></a>        <span class="n">_channel_data</span> <span class="o">=</span> <span class="n">tdms_channel</span>
</span><span id="WT_NoiseChannelProc-273"><a href="#WT_NoiseChannelProc-273"><span class="linenos">273</span></a>        <span class="c1"># desc</span>
</span><span id="WT_NoiseChannelProc-274"><a href="#WT_NoiseChannelProc-274"><span class="linenos">274</span></a>
</span><span id="WT_NoiseChannelProc-275"><a href="#WT_NoiseChannelProc-275"><span class="linenos">275</span></a>        <span class="n">fs_Hz</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">_channel_data</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s1">&#39;wf_increment&#39;</span><span class="p">]</span>
</span><span id="WT_NoiseChannelProc-276"><a href="#WT_NoiseChannelProc-276"><span class="linenos">276</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">_channel_data</span><span class="o">.</span><span class="n">data</span>
</span><span id="WT_NoiseChannelProc-277"><a href="#WT_NoiseChannelProc-277"><span class="linenos">277</span></a>        <span class="n">channel_name</span> <span class="o">=</span> <span class="n">_channel_data</span><span class="o">.</span><span class="n">name</span>
</span><span id="WT_NoiseChannelProc-278"><a href="#WT_NoiseChannelProc-278"><span class="linenos">278</span></a>        <span class="n">group_name</span> <span class="o">=</span> <span class="n">_channel_data</span><span class="o">.</span><span class="n">group_name</span>
</span><span id="WT_NoiseChannelProc-279"><a href="#WT_NoiseChannelProc-279"><span class="linenos">279</span></a>
</span><span id="WT_NoiseChannelProc-280"><a href="#WT_NoiseChannelProc-280"><span class="linenos">280</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">group_name</span><span class="p">,</span> <span class="n">_channel_data</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-281"><a href="#WT_NoiseChannelProc-281"><span class="linenos">281</span></a>                   <span class="n">operations</span><span class="o">=</span><span class="p">[</span>
</span><span id="WT_NoiseChannelProc-282"><a href="#WT_NoiseChannelProc-282"><span class="linenos">282</span></a>                       <span class="sa">f</span><span class="s1">&#39;Loaded from tdms file </span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">channel_name</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">fs_Hz</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</span><span id="WT_NoiseChannelProc-283"><a href="#WT_NoiseChannelProc-283"><span class="linenos">283</span></a>
</span><span id="WT_NoiseChannelProc-284"><a href="#WT_NoiseChannelProc-284"><span class="linenos">284</span></a>    <span class="nd">@classmethod</span>
</span><span id="WT_NoiseChannelProc-285"><a href="#WT_NoiseChannelProc-285"><span class="linenos">285</span></a>    <span class="k">def</span> <span class="nf">from_obj</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc-286"><a href="#WT_NoiseChannelProc-286"><span class="linenos">286</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;## Create factory method that generates an object class.</span>
</span><span id="WT_NoiseChannelProc-287"><a href="#WT_NoiseChannelProc-287"><span class="linenos">287</span></a>
</span><span id="WT_NoiseChannelProc-288"><a href="#WT_NoiseChannelProc-288"><span class="linenos">288</span></a><span class="sd">        ### If parameters are not provided the obj values are used.</span>
</span><span id="WT_NoiseChannelProc-289"><a href="#WT_NoiseChannelProc-289"><span class="linenos">289</span></a>
</span><span id="WT_NoiseChannelProc-290"><a href="#WT_NoiseChannelProc-290"><span class="linenos">290</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc-291"><a href="#WT_NoiseChannelProc-291"><span class="linenos">291</span></a><span class="sd">            tdms_channel (nptdms.tdms.TdmsChannel): tmds channel</span>
</span><span id="WT_NoiseChannelProc-292"><a href="#WT_NoiseChannelProc-292"><span class="linenos">292</span></a><span class="sd">            desc (str): descirption (used)</span>
</span><span id="WT_NoiseChannelProc-293"><a href="#WT_NoiseChannelProc-293"><span class="linenos">293</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc-294"><a href="#WT_NoiseChannelProc-294"><span class="linenos">294</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operation</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="kc">None</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="WT_NoiseChannelProc-295"><a href="#WT_NoiseChannelProc-295"><span class="linenos">295</span></a>        <span class="c1"># the following line allows to pass a description maybe</span>
</span><span id="WT_NoiseChannelProc-296"><a href="#WT_NoiseChannelProc-296"><span class="linenos">296</span></a>        <span class="n">desc</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">description</span> <span class="k">if</span> <span class="p">(</span>
</span><span id="WT_NoiseChannelProc-297"><a href="#WT_NoiseChannelProc-297"><span class="linenos">297</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
</span><span id="WT_NoiseChannelProc-298"><a href="#WT_NoiseChannelProc-298"><span class="linenos">298</span></a>                <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
</span><span id="WT_NoiseChannelProc-299"><a href="#WT_NoiseChannelProc-299"><span class="linenos">299</span></a>
</span><span id="WT_NoiseChannelProc-300"><a href="#WT_NoiseChannelProc-300"><span class="linenos">300</span></a>        <span class="n">_channel_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_channel_data&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">_channel_data</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-301"><a href="#WT_NoiseChannelProc-301"><span class="linenos">301</span></a>        <span class="n">fs_Hz</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fs_Hz&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">fs_Hz</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-302"><a href="#WT_NoiseChannelProc-302"><span class="linenos">302</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-303"><a href="#WT_NoiseChannelProc-303"><span class="linenos">303</span></a>        <span class="n">channel_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;channel_name&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">channel_name</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-304"><a href="#WT_NoiseChannelProc-304"><span class="linenos">304</span></a>        <span class="n">group_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;group_name&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">group_name</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-305"><a href="#WT_NoiseChannelProc-305"><span class="linenos">305</span></a>
</span><span id="WT_NoiseChannelProc-306"><a href="#WT_NoiseChannelProc-306"><span class="linenos">306</span></a>        <span class="n">new_ops</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="WT_NoiseChannelProc-307"><a href="#WT_NoiseChannelProc-307"><span class="linenos">307</span></a>        <span class="k">if</span> <span class="n">operation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="WT_NoiseChannelProc-308"><a href="#WT_NoiseChannelProc-308"><span class="linenos">308</span></a>            <span class="n">new_ops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">operation</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc-309"><a href="#WT_NoiseChannelProc-309"><span class="linenos">309</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">group_name</span><span class="p">,</span> <span class="n">_channel_data</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc-310"><a href="#WT_NoiseChannelProc-310"><span class="linenos">310</span></a>                   <span class="n">operations</span><span class="o">=</span><span class="n">new_ops</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Class for processing a tdms file for noise processing.</p>
</div>


                            <div id="WT_NoiseChannelProc.__init__" class="classattr">
                                        <input id="WT_NoiseChannelProc.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">WT_NoiseChannelProc</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">desc</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">fs_Hz</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">group_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">_channel_data</span>,</span><span class="param">	<span class="n">operations</span><span class="p">:</span> <span class="nb">list</span></span>)</span>

                <label class="view-source-button" for="WT_NoiseChannelProc.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WT_NoiseChannelProc.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WT_NoiseChannelProc.__init__-69"><a href="#WT_NoiseChannelProc.__init__-69"><span class="linenos">69</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.__init__-70"><a href="#WT_NoiseChannelProc.__init__-70"><span class="linenos">70</span></a>                 <span class="n">channel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">group_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">_channel_data</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.__init__-71"><a href="#WT_NoiseChannelProc.__init__-71"><span class="linenos">71</span></a>                 <span class="n">operations</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc.__init__-72"><a href="#WT_NoiseChannelProc.__init__-72"><span class="linenos">72</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize constructor for managing tdms files.&quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc.__init__-73"><a href="#WT_NoiseChannelProc.__init__-73"><span class="linenos">73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_channel_data</span> <span class="o">=</span> <span class="n">_channel_data</span>
</span><span id="WT_NoiseChannelProc.__init__-74"><a href="#WT_NoiseChannelProc.__init__-74"><span class="linenos">74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.__init__-75"><a href="#WT_NoiseChannelProc.__init__-75"><span class="linenos">75</span></a>        <span class="c1"># process details</span>
</span><span id="WT_NoiseChannelProc.__init__-76"><a href="#WT_NoiseChannelProc.__init__-76"><span class="linenos">76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span> <span class="o">=</span> <span class="n">fs_Hz</span>
</span><span id="WT_NoiseChannelProc.__init__-77"><a href="#WT_NoiseChannelProc.__init__-77"><span class="linenos">77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="WT_NoiseChannelProc.__init__-78"><a href="#WT_NoiseChannelProc.__init__-78"><span class="linenos">78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">channel_name</span> <span class="o">=</span> <span class="n">channel_name</span>
</span><span id="WT_NoiseChannelProc.__init__-79"><a href="#WT_NoiseChannelProc.__init__-79"><span class="linenos">79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">group_name</span> <span class="o">=</span> <span class="n">group_name</span>
</span><span id="WT_NoiseChannelProc.__init__-80"><a href="#WT_NoiseChannelProc.__init__-80"><span class="linenos">80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__measurement_history</span> <span class="o">=</span> <span class="n">operations</span>
</span></pre></div>


            <div class="docstring"><p>Initialize constructor for managing tdms files.</p>
</div>


                            </div>
                            <div id="WT_NoiseChannelProc.set_description" class="classattr">
                                        <input id="WT_NoiseChannelProc.set_description-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_description</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">desc</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="WT_NoiseChannelProc.set_description-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WT_NoiseChannelProc.set_description"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WT_NoiseChannelProc.set_description-82"><a href="#WT_NoiseChannelProc.set_description-82"><span class="linenos">82</span></a>    <span class="k">def</span> <span class="nf">set_description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc.set_description-83"><a href="#WT_NoiseChannelProc.set_description-83"><span class="linenos">83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the description of the file.</span>
</span><span id="WT_NoiseChannelProc.set_description-84"><a href="#WT_NoiseChannelProc.set_description-84"><span class="linenos">84</span></a>
</span><span id="WT_NoiseChannelProc.set_description-85"><a href="#WT_NoiseChannelProc.set_description-85"><span class="linenos">85</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc.set_description-86"><a href="#WT_NoiseChannelProc.set_description-86"><span class="linenos">86</span></a><span class="sd">            desc (_type_): _description_</span>
</span><span id="WT_NoiseChannelProc.set_description-87"><a href="#WT_NoiseChannelProc.set_description-87"><span class="linenos">87</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc.set_description-88"><a href="#WT_NoiseChannelProc.set_description-88"><span class="linenos">88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">desc</span>
</span></pre></div>


            <div class="docstring"><p>Set the description of the file.</p>

<p>Args:
    desc (_type_): _description_</p>
</div>


                            </div>
                            <div id="WT_NoiseChannelProc.operations" class="classattr">
                                <div class="attr variable">
            <span class="name">operations</span>

        
    </div>
    <a class="headerlink" href="#WT_NoiseChannelProc.operations"></a>
    
            <div class="docstring"><p>Capture operations on data.</p>
</div>


                            </div>
                            <div id="WT_NoiseChannelProc.data_as_Series" class="classattr">
                                <div class="attr variable">
            <span class="name">data_as_Series</span><span class="annotation">: pandas.core.series.Series</span>

        
    </div>
    <a class="headerlink" href="#WT_NoiseChannelProc.data_as_Series"></a>
    
            <div class="docstring"><p>Return the raw data as a pd.Series.</p>

<p>Returns:
    _type_: _description_</p>
</div>


                            </div>
                            <div id="WT_NoiseChannelProc.average" class="classattr">
                                        <input id="WT_NoiseChannelProc.average-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">average</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">fr_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span>, </span><span class="param"><span class="n">desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="WT_NoiseChannelProc.average-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WT_NoiseChannelProc.average"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WT_NoiseChannelProc.average-104"><a href="#WT_NoiseChannelProc.average-104"><span class="linenos">104</span></a>    <span class="k">def</span> <span class="nf">average</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fr_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc.average-105"><a href="#WT_NoiseChannelProc.average-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return another object.</span>
</span><span id="WT_NoiseChannelProc.average-106"><a href="#WT_NoiseChannelProc.average-106"><span class="linenos">106</span></a>
</span><span id="WT_NoiseChannelProc.average-107"><a href="#WT_NoiseChannelProc.average-107"><span class="linenos">107</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc.average-108"><a href="#WT_NoiseChannelProc.average-108"><span class="linenos">108</span></a><span class="sd">        - fr_Hz (float) : recording frequency (with averaging)</span>
</span><span id="WT_NoiseChannelProc.average-109"><a href="#WT_NoiseChannelProc.average-109"><span class="linenos">109</span></a><span class="sd">        - desc (str) : description</span>
</span><span id="WT_NoiseChannelProc.average-110"><a href="#WT_NoiseChannelProc.average-110"><span class="linenos">110</span></a><span class="sd">            - Defaults to None: ie. add suffix _Av:&lt;fr_Hz&gt;)</span>
</span><span id="WT_NoiseChannelProc.average-111"><a href="#WT_NoiseChannelProc.average-111"><span class="linenos">111</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc.average-112"><a href="#WT_NoiseChannelProc.average-112"><span class="linenos">112</span></a>        <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_as_Series</span>
</span><span id="WT_NoiseChannelProc.average-113"><a href="#WT_NoiseChannelProc.average-113"><span class="linenos">113</span></a>        <span class="n">fs_Hz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span>
</span><span id="WT_NoiseChannelProc.average-114"><a href="#WT_NoiseChannelProc.average-114"><span class="linenos">114</span></a>
</span><span id="WT_NoiseChannelProc.average-115"><a href="#WT_NoiseChannelProc.average-115"><span class="linenos">115</span></a>        <span class="n">ds_fr</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">index</span> <span class="o">//</span> <span class="p">(</span><span class="n">fs_Hz</span> <span class="o">/</span> <span class="n">fr_Hz</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</span><span id="WT_NoiseChannelProc.average-116"><a href="#WT_NoiseChannelProc.average-116"><span class="linenos">116</span></a>
</span><span id="WT_NoiseChannelProc.average-117"><a href="#WT_NoiseChannelProc.average-117"><span class="linenos">117</span></a>        <span class="n">description</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="WT_NoiseChannelProc.average-118"><a href="#WT_NoiseChannelProc.average-118"><span class="linenos">118</span></a>            <span class="n">desc</span> <span class="k">if</span> <span class="n">desc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;_Av:</span><span class="si">{</span><span class="n">fr_Hz</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.average-119"><a href="#WT_NoiseChannelProc.average-119"><span class="linenos">119</span></a>        <span class="c1"># TODO need to think better the naming conventions</span>
</span><span id="WT_NoiseChannelProc.average-120"><a href="#WT_NoiseChannelProc.average-120"><span class="linenos">120</span></a>        <span class="c1"># (consider using a dictionary with multiple keys</span>
</span><span id="WT_NoiseChannelProc.average-121"><a href="#WT_NoiseChannelProc.average-121"><span class="linenos">121</span></a>        <span class="c1"># e.g. different for plots etc)</span>
</span><span id="WT_NoiseChannelProc.average-122"><a href="#WT_NoiseChannelProc.average-122"><span class="linenos">122</span></a>        <span class="n">new_operations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="WT_NoiseChannelProc.average-123"><a href="#WT_NoiseChannelProc.average-123"><span class="linenos">123</span></a>        <span class="n">new_operations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Apply Averaging :</span><span class="si">{</span><span class="n">fr_Hz</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.average-124"><a href="#WT_NoiseChannelProc.average-124"><span class="linenos">124</span></a>
</span><span id="WT_NoiseChannelProc.average-125"><a href="#WT_NoiseChannelProc.average-125"><span class="linenos">125</span></a>        <span class="k">return</span> <span class="n">WT_NoiseChannelProc</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.average-126"><a href="#WT_NoiseChannelProc.average-126"><span class="linenos">126</span></a>                                   <span class="n">fs_Hz</span><span class="o">=</span><span class="n">fr_Hz</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ds_fr</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.average-127"><a href="#WT_NoiseChannelProc.average-127"><span class="linenos">127</span></a>                                   <span class="n">channel_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.average-128"><a href="#WT_NoiseChannelProc.average-128"><span class="linenos">128</span></a>                                   <span class="n">group_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">group_name</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.average-129"><a href="#WT_NoiseChannelProc.average-129"><span class="linenos">129</span></a>                                   <span class="n">_channel_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.average-130"><a href="#WT_NoiseChannelProc.average-130"><span class="linenos">130</span></a>                                   <span class="n">operations</span><span class="o">=</span><span class="n">new_operations</span>
</span><span id="WT_NoiseChannelProc.average-131"><a href="#WT_NoiseChannelProc.average-131"><span class="linenos">131</span></a>                                   <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return another object.</p>

<p>Args:</p>

<ul>
<li>fr_Hz (float) : recording frequency (with averaging)</li>
<li>desc (str) : description
<ul>
<li>Defaults to None: ie. add suffix _Av:<fr_Hz>)</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="WT_NoiseChannelProc.set_desc" class="classattr">
                                        <input id="WT_NoiseChannelProc.set_desc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_desc</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">desc</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="WT_NoiseChannelProc.set_desc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WT_NoiseChannelProc.set_desc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WT_NoiseChannelProc.set_desc-133"><a href="#WT_NoiseChannelProc.set_desc-133"><span class="linenos">133</span></a>    <span class="k">def</span> <span class="nf">set_desc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc.set_desc-134"><a href="#WT_NoiseChannelProc.set_desc-134"><span class="linenos">134</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set description for any operation or info for the data object.&quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc.set_desc-135"><a href="#WT_NoiseChannelProc.set_desc-135"><span class="linenos">135</span></a>        <span class="k">return</span> <span class="n">WT_NoiseChannelProc</span><span class="o">.</span><span class="n">from_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.set_desc-136"><a href="#WT_NoiseChannelProc.set_desc-136"><span class="linenos">136</span></a>                                            <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Set description for any operation or info for the data object.</p>
</div>


                            </div>
                            <div id="WT_NoiseChannelProc.decimate" class="classattr">
                                        <input id="WT_NoiseChannelProc.decimate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">decimate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">dec</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="WT_NoiseChannelProc.decimate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WT_NoiseChannelProc.decimate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WT_NoiseChannelProc.decimate-138"><a href="#WT_NoiseChannelProc.decimate-138"><span class="linenos">138</span></a>    <span class="k">def</span> <span class="nf">decimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dec</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc.decimate-139"><a href="#WT_NoiseChannelProc.decimate-139"><span class="linenos">139</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a decimated data seires.</span>
</span><span id="WT_NoiseChannelProc.decimate-140"><a href="#WT_NoiseChannelProc.decimate-140"><span class="linenos">140</span></a>
</span><span id="WT_NoiseChannelProc.decimate-141"><a href="#WT_NoiseChannelProc.decimate-141"><span class="linenos">141</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc.decimate-142"><a href="#WT_NoiseChannelProc.decimate-142"><span class="linenos">142</span></a><span class="sd">        - dec (int): decimation factor</span>
</span><span id="WT_NoiseChannelProc.decimate-143"><a href="#WT_NoiseChannelProc.decimate-143"><span class="linenos">143</span></a><span class="sd">        - offset (int): initial offset</span>
</span><span id="WT_NoiseChannelProc.decimate-144"><a href="#WT_NoiseChannelProc.decimate-144"><span class="linenos">144</span></a>
</span><span id="WT_NoiseChannelProc.decimate-145"><a href="#WT_NoiseChannelProc.decimate-145"><span class="linenos">145</span></a><span class="sd">        Returns:</span>
</span><span id="WT_NoiseChannelProc.decimate-146"><a href="#WT_NoiseChannelProc.decimate-146"><span class="linenos">146</span></a><span class="sd">        - WT_NoiseChannelProc.obj: a decimated data series.</span>
</span><span id="WT_NoiseChannelProc.decimate-147"><a href="#WT_NoiseChannelProc.decimate-147"><span class="linenos">147</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc.decimate-148"><a href="#WT_NoiseChannelProc.decimate-148"><span class="linenos">148</span></a>        <span class="n">decimated_fs_Hz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span><span class="o">/</span><span class="n">dec</span>
</span><span id="WT_NoiseChannelProc.decimate-149"><a href="#WT_NoiseChannelProc.decimate-149"><span class="linenos">149</span></a>
</span><span id="WT_NoiseChannelProc.decimate-150"><a href="#WT_NoiseChannelProc.decimate-150"><span class="linenos">150</span></a>        <span class="n">new_operation</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="WT_NoiseChannelProc.decimate-151"><a href="#WT_NoiseChannelProc.decimate-151"><span class="linenos">151</span></a>            <span class="sa">f</span><span class="s1">&#39;Decimation factor:</span><span class="si">{</span><span class="n">dec</span><span class="si">}</span><span class="s1">, Offset:</span><span class="si">{</span><span class="n">offset</span><span class="si">}</span><span class="s1">, new fs_Hz:</span><span class="si">{</span><span class="n">decimated_fs_Hz</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.decimate-152"><a href="#WT_NoiseChannelProc.decimate-152"><span class="linenos">152</span></a>
</span><span id="WT_NoiseChannelProc.decimate-153"><a href="#WT_NoiseChannelProc.decimate-153"><span class="linenos">153</span></a>        <span class="k">return</span> <span class="n">WT_NoiseChannelProc</span><span class="o">.</span><span class="n">from_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.decimate-154"><a href="#WT_NoiseChannelProc.decimate-154"><span class="linenos">154</span></a>                                            <span class="n">operation</span><span class="o">=</span><span class="n">new_operation</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.decimate-155"><a href="#WT_NoiseChannelProc.decimate-155"><span class="linenos">155</span></a>                                            <span class="n">fs_Hz</span><span class="o">=</span><span class="n">decimated_fs_Hz</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.decimate-156"><a href="#WT_NoiseChannelProc.decimate-156"><span class="linenos">156</span></a>                                            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">offset</span><span class="p">::</span><span class="n">dec</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Return a decimated data seires.</p>

<p>Args:</p>

<ul>
<li>dec (int): decimation factor</li>
<li>offset (int): initial offset</li>
</ul>

<p>Returns:</p>

<ul>
<li>WT_NoiseChannelProc.obj: a decimated data series.</li>
</ul>
</div>


                            </div>
                            <div id="WT_NoiseChannelProc.filter" class="classattr">
                                        <input id="WT_NoiseChannelProc.filter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">filter_func</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">filt_butter_factory</span><span class="o">.&lt;</span><span class="nb">locals</span><span class="o">&gt;.</span><span class="n">filt_butter</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">fs_Hz</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">desc</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="WT_NoiseChannelProc.filter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WT_NoiseChannelProc.filter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WT_NoiseChannelProc.filter-186"><a href="#WT_NoiseChannelProc.filter-186"><span class="linenos">186</span></a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.filter-187"><a href="#WT_NoiseChannelProc.filter-187"><span class="linenos">187</span></a>               <span class="n">filter_func</span><span class="o">=</span><span class="n">filter_Butter_default</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.filter-188"><a href="#WT_NoiseChannelProc.filter-188"><span class="linenos">188</span></a>               <span class="n">fs_Hz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc.filter-189"><a href="#WT_NoiseChannelProc.filter-189"><span class="linenos">189</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter a signal with the chosen factory method (IIR, FIR).&quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc.filter-190"><a href="#WT_NoiseChannelProc.filter-190"><span class="linenos">190</span></a>        <span class="n">ds_filt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter</span><span class="p">(</span><span class="n">fc_Hz</span><span class="o">=</span><span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.filter-191"><a href="#WT_NoiseChannelProc.filter-191"><span class="linenos">191</span></a>                               <span class="n">filter_func</span><span class="o">=</span><span class="n">filter_func</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.filter-192"><a href="#WT_NoiseChannelProc.filter-192"><span class="linenos">192</span></a>                               <span class="n">fs_Hz</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.filter-193"><a href="#WT_NoiseChannelProc.filter-193"><span class="linenos">193</span></a>        <span class="c1"># description = (</span>
</span><span id="WT_NoiseChannelProc.filter-194"><a href="#WT_NoiseChannelProc.filter-194"><span class="linenos">194</span></a>        <span class="c1">#     desc if desc is not None else self.description + f&quot;_fc:{fc_Hz}&quot;)</span>
</span><span id="WT_NoiseChannelProc.filter-195"><a href="#WT_NoiseChannelProc.filter-195"><span class="linenos">195</span></a>        <span class="k">return</span> <span class="n">WT_NoiseChannelProc</span><span class="o">.</span><span class="n">from_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.filter-196"><a href="#WT_NoiseChannelProc.filter-196"><span class="linenos">196</span></a>                                            <span class="n">data</span><span class="o">=</span><span class="n">ds_filt</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.filter-197"><a href="#WT_NoiseChannelProc.filter-197"><span class="linenos">197</span></a>                                            <span class="n">operation</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;pass filter </span><span class="si">{</span><span class="n">fc_Hz</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="WT_NoiseChannelProc.filter-198"><a href="#WT_NoiseChannelProc.filter-198"><span class="linenos">198</span></a>                                            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Filter a signal with the chosen factory method (IIR, FIR).</p>
</div>


                            </div>
                            <div id="WT_NoiseChannelProc.calc_spectrum" class="classattr">
                                        <input id="WT_NoiseChannelProc.calc_spectrum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calc_spectrum</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">window</span><span class="o">=</span><span class="s1">&#39;flattop&#39;</span>,</span><span class="param">	<span class="n">nperseg</span><span class="o">=</span><span class="mi">1024</span>,</span><span class="param">	<span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;density&#39;</span></span><span class="return-annotation">) -> <span class="n"><a href="Graph_data_container.html#Graph_data_container">pros_noisefiltering.Graph_data_container.Graph_data_container</a></span>:</span></span>

                <label class="view-source-button" for="WT_NoiseChannelProc.calc_spectrum-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WT_NoiseChannelProc.calc_spectrum"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WT_NoiseChannelProc.calc_spectrum-200"><a href="#WT_NoiseChannelProc.calc_spectrum-200"><span class="linenos">200</span></a>    <span class="k">def</span> <span class="nf">calc_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum-201"><a href="#WT_NoiseChannelProc.calc_spectrum-201"><span class="linenos">201</span></a>                      <span class="n">window</span><span class="o">=</span><span class="s1">&#39;flattop&#39;</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">1_024</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum-202"><a href="#WT_NoiseChannelProc.calc_spectrum-202"><span class="linenos">202</span></a>                      <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graph_data_container</span><span class="p">:</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum-203"><a href="#WT_NoiseChannelProc.calc_spectrum-203"><span class="linenos">203</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Graph_data_container object.</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum-204"><a href="#WT_NoiseChannelProc.calc_spectrum-204"><span class="linenos">204</span></a>
</span><span id="WT_NoiseChannelProc.calc_spectrum-205"><a href="#WT_NoiseChannelProc.calc_spectrum-205"><span class="linenos">205</span></a><span class="sd">        with:</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum-206"><a href="#WT_NoiseChannelProc.calc_spectrum-206"><span class="linenos">206</span></a><span class="sd">        - the power spectrum of the data.</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum-207"><a href="#WT_NoiseChannelProc.calc_spectrum-207"><span class="linenos">207</span></a><span class="sd">        - uses the decimation function</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum-208"><a href="#WT_NoiseChannelProc.calc_spectrum-208"><span class="linenos">208</span></a>
</span><span id="WT_NoiseChannelProc.calc_spectrum-209"><a href="#WT_NoiseChannelProc.calc_spectrum-209"><span class="linenos">209</span></a><span class="sd">        Returns:</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum-210"><a href="#WT_NoiseChannelProc.calc_spectrum-210"><span class="linenos">210</span></a><span class="sd">        - classmethod: Graph_data_container</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum-211"><a href="#WT_NoiseChannelProc.calc_spectrum-211"><span class="linenos">211</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum-212"><a href="#WT_NoiseChannelProc.calc_spectrum-212"><span class="linenos">212</span></a>        <span class="n">gobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_spectrum_gen</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum-213"><a href="#WT_NoiseChannelProc.calc_spectrum-213"><span class="linenos">213</span></a>                                      <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="n">scaling</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum-214"><a href="#WT_NoiseChannelProc.calc_spectrum-214"><span class="linenos">214</span></a>        <span class="k">return</span> <span class="n">gobj</span>
</span></pre></div>


            <div class="docstring"><p>Return a Graph_data_container object.</p>

<p>with:</p>

<ul>
<li>the power spectrum of the data.</li>
<li>uses the decimation function</li>
</ul>

<p>Returns:</p>

<ul>
<li>classmethod: Graph_data_container</li>
</ul>
</div>


                            </div>
                            <div id="WT_NoiseChannelProc.calc_spectrum_gen" class="classattr">
                                        <input id="WT_NoiseChannelProc.calc_spectrum_gen-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calc_spectrum_gen</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">dec</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">window</span><span class="o">=</span><span class="s1">&#39;flattop&#39;</span>,</span><span class="param">	<span class="n">nperseg</span><span class="o">=</span><span class="mi">1024</span>,</span><span class="param">	<span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;density&#39;</span></span><span class="return-annotation">) -> <span class="n"><a href="Graph_data_container.html#Graph_data_container">pros_noisefiltering.Graph_data_container.Graph_data_container</a></span>:</span></span>

                <label class="view-source-button" for="WT_NoiseChannelProc.calc_spectrum_gen-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WT_NoiseChannelProc.calc_spectrum_gen"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WT_NoiseChannelProc.calc_spectrum_gen-216"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-216"><span class="linenos">216</span></a>    <span class="k">def</span> <span class="nf">calc_spectrum_gen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dec</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-217"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-217"><span class="linenos">217</span></a>                          <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-218"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-218"><span class="linenos">218</span></a>                          <span class="n">window</span><span class="o">=</span><span class="s1">&#39;flattop&#39;</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-219"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-219"><span class="linenos">219</span></a>                          <span class="n">nperseg</span><span class="o">=</span><span class="mi">1_024</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-220"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-220"><span class="linenos">220</span></a>                          <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graph_data_container</span><span class="p">:</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-221"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-221"><span class="linenos">221</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create function for calculating the spectrum of a time series.</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-222"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-222"><span class="linenos">222</span></a>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-223"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-223"><span class="linenos">223</span></a><span class="sd">        Return a Graph_data_container object with the power spectrum</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-224"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-224"><span class="linenos">224</span></a><span class="sd">        of the **decimated** data.</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-225"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-225"><span class="linenos">225</span></a>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-226"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-226"><span class="linenos">226</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-227"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-227"><span class="linenos">227</span></a><span class="sd">        - dec (int): decimation factor</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-228"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-228"><span class="linenos">228</span></a><span class="sd">        - offset (int, optional): offset.</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-229"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-229"><span class="linenos">229</span></a><span class="sd">            - Defaults to 0.</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-230"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-230"><span class="linenos">230</span></a>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-231"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-231"><span class="linenos">231</span></a><span class="sd">        Returns:</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-232"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-232"><span class="linenos">232</span></a><span class="sd">        - Graph_data_container: Containing the spectral density of the given</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-233"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-233"><span class="linenos">233</span></a><span class="sd">        signal.</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-234"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-234"><span class="linenos">234</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-235"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-235"><span class="linenos">235</span></a>        <span class="n">decimated_fs_Hz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs_Hz</span><span class="o">/</span><span class="n">dec</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-236"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-236"><span class="linenos">236</span></a>        <span class="n">x_r</span><span class="p">,</span> <span class="n">y_r</span> <span class="o">=</span> <span class="n">spect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">offset</span><span class="p">::</span><span class="n">dec</span><span class="p">],</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-237"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-237"><span class="linenos">237</span></a>                         <span class="n">FS</span><span class="o">=</span><span class="n">decimated_fs_Hz</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-238"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-238"><span class="linenos">238</span></a>                         <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-239"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-239"><span class="linenos">239</span></a>                         <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-240"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-240"><span class="linenos">240</span></a>                         <span class="n">scaling</span><span class="o">=</span><span class="n">scaling</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-241"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-241"><span class="linenos">241</span></a>        <span class="k">if</span> <span class="n">dec</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-242"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-242"><span class="linenos">242</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-243"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-243"><span class="linenos">243</span></a>            <span class="c1"># TODO the new chain method approach does not require this.</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-244"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-244"><span class="linenos">244</span></a>            <span class="c1"># This is a remnant from the original approach.</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-245"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-245"><span class="linenos">245</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-246"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-246"><span class="linenos">246</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-247"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-247"><span class="linenos">247</span></a>                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_name</span><span class="si">}</span><span class="s1">-fs:</span><span class="si">{</span><span class="n">decimated_fs_Hz</span><span class="o">/</span><span class="mi">1000</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">kHz &#39;</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-248"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-248"><span class="linenos">248</span></a>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-249"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-249"><span class="linenos">249</span></a>        <span class="k">return</span> <span class="n">Graph_data_container</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_r</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_r</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.calc_spectrum_gen-250"><a href="#WT_NoiseChannelProc.calc_spectrum_gen-250"><span class="linenos">250</span></a>                                    <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create function for calculating the spectrum of a time series.</p>

<p>Return a Graph_data_container object with the power spectrum
of the <strong>decimated</strong> data.</p>

<p>Args:</p>

<ul>
<li>dec (int): decimation factor</li>
<li>offset (int, optional): offset.
<ul>
<li>Defaults to 0.</li>
</ul></li>
</ul>

<p>Returns:</p>

<ul>
<li>Graph_data_container: Containing the spectral density of the given
signal.</li>
</ul>
</div>


                            </div>
                            <div id="WT_NoiseChannelProc.plot_filtered_th" class="classattr">
                                        <input id="WT_NoiseChannelProc.plot_filtered_th-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_filtered_th</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filter_func</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="WT_NoiseChannelProc.plot_filtered_th-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WT_NoiseChannelProc.plot_filtered_th"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WT_NoiseChannelProc.plot_filtered_th-252"><a href="#WT_NoiseChannelProc.plot_filtered_th-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">plot_filtered_th</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_func</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc.plot_filtered_th-253"><a href="#WT_NoiseChannelProc.plot_filtered_th-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the Time History.</span>
</span><span id="WT_NoiseChannelProc.plot_filtered_th-254"><a href="#WT_NoiseChannelProc.plot_filtered_th-254"><span class="linenos">254</span></a>
</span><span id="WT_NoiseChannelProc.plot_filtered_th-255"><a href="#WT_NoiseChannelProc.plot_filtered_th-255"><span class="linenos">255</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc.plot_filtered_th-256"><a href="#WT_NoiseChannelProc.plot_filtered_th-256"><span class="linenos">256</span></a><span class="sd">        - filter_func (factory method): Choose the wanted filter</span>
</span><span id="WT_NoiseChannelProc.plot_filtered_th-257"><a href="#WT_NoiseChannelProc.plot_filtered_th-257"><span class="linenos">257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc.plot_filtered_th-258"><a href="#WT_NoiseChannelProc.plot_filtered_th-258"><span class="linenos">258</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.plot_filtered_th-259"><a href="#WT_NoiseChannelProc.plot_filtered_th-259"><span class="linenos">259</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">filter_func</span><span class="o">=</span><span class="n">filter_func</span><span class="p">),</span>
</span><span id="WT_NoiseChannelProc.plot_filtered_th-260"><a href="#WT_NoiseChannelProc.plot_filtered_th-260"><span class="linenos">260</span></a>                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;filtered: </span><span class="si">{</span><span class="n">filter_func</span><span class="o">.</span><span class="n">params</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plot the Time History.</p>

<p>Args:</p>

<ul>
<li>filter_func (factory method): Choose the wanted filter</li>
</ul>
</div>


                            </div>
                            <div id="WT_NoiseChannelProc.from_tdms" class="classattr">
                                        <input id="WT_NoiseChannelProc.from_tdms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_tdms</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">tdms_channel</span><span class="p">:</span> <span class="n">nptdms</span><span class="o">.</span><span class="n">tdms</span><span class="o">.</span><span class="n">TdmsChannel</span>, </span><span class="param"><span class="n">desc</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="WT_NoiseChannelProc.from_tdms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WT_NoiseChannelProc.from_tdms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WT_NoiseChannelProc.from_tdms-262"><a href="#WT_NoiseChannelProc.from_tdms-262"><span class="linenos">262</span></a>    <span class="nd">@classmethod</span>
</span><span id="WT_NoiseChannelProc.from_tdms-263"><a href="#WT_NoiseChannelProc.from_tdms-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">from_tdms</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">tdms_channel</span><span class="p">:</span> <span class="n">nptdms</span><span class="o">.</span><span class="n">tdms</span><span class="o">.</span><span class="n">TdmsChannel</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc.from_tdms-264"><a href="#WT_NoiseChannelProc.from_tdms-264"><span class="linenos">264</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;## Initiate factory method that generates an object class.</span>
</span><span id="WT_NoiseChannelProc.from_tdms-265"><a href="#WT_NoiseChannelProc.from_tdms-265"><span class="linenos">265</span></a>
</span><span id="WT_NoiseChannelProc.from_tdms-266"><a href="#WT_NoiseChannelProc.from_tdms-266"><span class="linenos">266</span></a><span class="sd">        #### TOD need to change the init function and test.</span>
</span><span id="WT_NoiseChannelProc.from_tdms-267"><a href="#WT_NoiseChannelProc.from_tdms-267"><span class="linenos">267</span></a>
</span><span id="WT_NoiseChannelProc.from_tdms-268"><a href="#WT_NoiseChannelProc.from_tdms-268"><span class="linenos">268</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc.from_tdms-269"><a href="#WT_NoiseChannelProc.from_tdms-269"><span class="linenos">269</span></a><span class="sd">        - tdms_channel (nptdms.tdms.TdmsChannel): tmds channel name</span>
</span><span id="WT_NoiseChannelProc.from_tdms-270"><a href="#WT_NoiseChannelProc.from_tdms-270"><span class="linenos">270</span></a><span class="sd">        - desc (str): descirption (used)</span>
</span><span id="WT_NoiseChannelProc.from_tdms-271"><a href="#WT_NoiseChannelProc.from_tdms-271"><span class="linenos">271</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc.from_tdms-272"><a href="#WT_NoiseChannelProc.from_tdms-272"><span class="linenos">272</span></a>        <span class="n">_channel_data</span> <span class="o">=</span> <span class="n">tdms_channel</span>
</span><span id="WT_NoiseChannelProc.from_tdms-273"><a href="#WT_NoiseChannelProc.from_tdms-273"><span class="linenos">273</span></a>        <span class="c1"># desc</span>
</span><span id="WT_NoiseChannelProc.from_tdms-274"><a href="#WT_NoiseChannelProc.from_tdms-274"><span class="linenos">274</span></a>
</span><span id="WT_NoiseChannelProc.from_tdms-275"><a href="#WT_NoiseChannelProc.from_tdms-275"><span class="linenos">275</span></a>        <span class="n">fs_Hz</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">_channel_data</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s1">&#39;wf_increment&#39;</span><span class="p">]</span>
</span><span id="WT_NoiseChannelProc.from_tdms-276"><a href="#WT_NoiseChannelProc.from_tdms-276"><span class="linenos">276</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">_channel_data</span><span class="o">.</span><span class="n">data</span>
</span><span id="WT_NoiseChannelProc.from_tdms-277"><a href="#WT_NoiseChannelProc.from_tdms-277"><span class="linenos">277</span></a>        <span class="n">channel_name</span> <span class="o">=</span> <span class="n">_channel_data</span><span class="o">.</span><span class="n">name</span>
</span><span id="WT_NoiseChannelProc.from_tdms-278"><a href="#WT_NoiseChannelProc.from_tdms-278"><span class="linenos">278</span></a>        <span class="n">group_name</span> <span class="o">=</span> <span class="n">_channel_data</span><span class="o">.</span><span class="n">group_name</span>
</span><span id="WT_NoiseChannelProc.from_tdms-279"><a href="#WT_NoiseChannelProc.from_tdms-279"><span class="linenos">279</span></a>
</span><span id="WT_NoiseChannelProc.from_tdms-280"><a href="#WT_NoiseChannelProc.from_tdms-280"><span class="linenos">280</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">group_name</span><span class="p">,</span> <span class="n">_channel_data</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.from_tdms-281"><a href="#WT_NoiseChannelProc.from_tdms-281"><span class="linenos">281</span></a>                   <span class="n">operations</span><span class="o">=</span><span class="p">[</span>
</span><span id="WT_NoiseChannelProc.from_tdms-282"><a href="#WT_NoiseChannelProc.from_tdms-282"><span class="linenos">282</span></a>                       <span class="sa">f</span><span class="s1">&#39;Loaded from tdms file </span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">channel_name</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">fs_Hz</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><h2 id="initiate-factory-method-that-generates-an-object-class">Initiate factory method that generates an object class.</h2>

<h4 id="tod-need-to-change-the-init-function-and-test">TOD need to change the init function and test.</h4>

<p>Args:</p>

<ul>
<li>tdms_channel (nptdms.tdms.TdmsChannel): tmds channel name</li>
<li>desc (str): descirption (used)</li>
</ul>
</div>


                            </div>
                            <div id="WT_NoiseChannelProc.from_obj" class="classattr">
                                        <input id="WT_NoiseChannelProc.from_obj-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_obj</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">obj</span>, </span><span class="param"><span class="n">operation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="WT_NoiseChannelProc.from_obj-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WT_NoiseChannelProc.from_obj"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WT_NoiseChannelProc.from_obj-284"><a href="#WT_NoiseChannelProc.from_obj-284"><span class="linenos">284</span></a>    <span class="nd">@classmethod</span>
</span><span id="WT_NoiseChannelProc.from_obj-285"><a href="#WT_NoiseChannelProc.from_obj-285"><span class="linenos">285</span></a>    <span class="k">def</span> <span class="nf">from_obj</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="WT_NoiseChannelProc.from_obj-286"><a href="#WT_NoiseChannelProc.from_obj-286"><span class="linenos">286</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;## Create factory method that generates an object class.</span>
</span><span id="WT_NoiseChannelProc.from_obj-287"><a href="#WT_NoiseChannelProc.from_obj-287"><span class="linenos">287</span></a>
</span><span id="WT_NoiseChannelProc.from_obj-288"><a href="#WT_NoiseChannelProc.from_obj-288"><span class="linenos">288</span></a><span class="sd">        ### If parameters are not provided the obj values are used.</span>
</span><span id="WT_NoiseChannelProc.from_obj-289"><a href="#WT_NoiseChannelProc.from_obj-289"><span class="linenos">289</span></a>
</span><span id="WT_NoiseChannelProc.from_obj-290"><a href="#WT_NoiseChannelProc.from_obj-290"><span class="linenos">290</span></a><span class="sd">        Args:</span>
</span><span id="WT_NoiseChannelProc.from_obj-291"><a href="#WT_NoiseChannelProc.from_obj-291"><span class="linenos">291</span></a><span class="sd">            tdms_channel (nptdms.tdms.TdmsChannel): tmds channel</span>
</span><span id="WT_NoiseChannelProc.from_obj-292"><a href="#WT_NoiseChannelProc.from_obj-292"><span class="linenos">292</span></a><span class="sd">            desc (str): descirption (used)</span>
</span><span id="WT_NoiseChannelProc.from_obj-293"><a href="#WT_NoiseChannelProc.from_obj-293"><span class="linenos">293</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WT_NoiseChannelProc.from_obj-294"><a href="#WT_NoiseChannelProc.from_obj-294"><span class="linenos">294</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operation</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="kc">None</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="WT_NoiseChannelProc.from_obj-295"><a href="#WT_NoiseChannelProc.from_obj-295"><span class="linenos">295</span></a>        <span class="c1"># the following line allows to pass a description maybe</span>
</span><span id="WT_NoiseChannelProc.from_obj-296"><a href="#WT_NoiseChannelProc.from_obj-296"><span class="linenos">296</span></a>        <span class="n">desc</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">description</span> <span class="k">if</span> <span class="p">(</span>
</span><span id="WT_NoiseChannelProc.from_obj-297"><a href="#WT_NoiseChannelProc.from_obj-297"><span class="linenos">297</span></a>            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
</span><span id="WT_NoiseChannelProc.from_obj-298"><a href="#WT_NoiseChannelProc.from_obj-298"><span class="linenos">298</span></a>                <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;desc&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
</span><span id="WT_NoiseChannelProc.from_obj-299"><a href="#WT_NoiseChannelProc.from_obj-299"><span class="linenos">299</span></a>
</span><span id="WT_NoiseChannelProc.from_obj-300"><a href="#WT_NoiseChannelProc.from_obj-300"><span class="linenos">300</span></a>        <span class="n">_channel_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_channel_data&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">_channel_data</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.from_obj-301"><a href="#WT_NoiseChannelProc.from_obj-301"><span class="linenos">301</span></a>        <span class="n">fs_Hz</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fs_Hz&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">fs_Hz</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.from_obj-302"><a href="#WT_NoiseChannelProc.from_obj-302"><span class="linenos">302</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.from_obj-303"><a href="#WT_NoiseChannelProc.from_obj-303"><span class="linenos">303</span></a>        <span class="n">channel_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;channel_name&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">channel_name</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.from_obj-304"><a href="#WT_NoiseChannelProc.from_obj-304"><span class="linenos">304</span></a>        <span class="n">group_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;group_name&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">group_name</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.from_obj-305"><a href="#WT_NoiseChannelProc.from_obj-305"><span class="linenos">305</span></a>
</span><span id="WT_NoiseChannelProc.from_obj-306"><a href="#WT_NoiseChannelProc.from_obj-306"><span class="linenos">306</span></a>        <span class="n">new_ops</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="WT_NoiseChannelProc.from_obj-307"><a href="#WT_NoiseChannelProc.from_obj-307"><span class="linenos">307</span></a>        <span class="k">if</span> <span class="n">operation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="WT_NoiseChannelProc.from_obj-308"><a href="#WT_NoiseChannelProc.from_obj-308"><span class="linenos">308</span></a>            <span class="n">new_ops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">operation</span><span class="p">)</span>
</span><span id="WT_NoiseChannelProc.from_obj-309"><a href="#WT_NoiseChannelProc.from_obj-309"><span class="linenos">309</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">group_name</span><span class="p">,</span> <span class="n">_channel_data</span><span class="p">,</span>
</span><span id="WT_NoiseChannelProc.from_obj-310"><a href="#WT_NoiseChannelProc.from_obj-310"><span class="linenos">310</span></a>                   <span class="n">operations</span><span class="o">=</span><span class="n">new_ops</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h2 id="create-factory-method-that-generates-an-object-class">Create factory method that generates an object class.</h2>

<h3 id="if-parameters-are-not-provided-the-obj-values-are-used">If parameters are not provided the obj values are used.</h3>

<p>Args:
    tdms_channel (nptdms.tdms.TdmsChannel): tmds channel
    desc (str): descirption (used)</p>
</div>


                            </div>
                </section>
                <section id="Plotter_Class">
                            <input id="Plotter_Class-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Plotter_Class</span>:

                <label class="view-source-button" for="Plotter_Class-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plotter_Class"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plotter_Class-314"><a href="#Plotter_Class-314"><span class="linenos">314</span></a><span class="k">class</span> <span class="nc">Plotter_Class</span><span class="p">():</span>
</span><span id="Plotter_Class-315"><a href="#Plotter_Class-315"><span class="linenos">315</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;# This is a class that can take different objects for plotting.</span>
</span><span id="Plotter_Class-316"><a href="#Plotter_Class-316"><span class="linenos">316</span></a>
</span><span id="Plotter_Class-317"><a href="#Plotter_Class-317"><span class="linenos">317</span></a><span class="sd">    Takes their raw data and plots:</span>
</span><span id="Plotter_Class-318"><a href="#Plotter_Class-318"><span class="linenos">318</span></a><span class="sd">    - a overview for the signal in frequency and time domains</span>
</span><span id="Plotter_Class-319"><a href="#Plotter_Class-319"><span class="linenos">319</span></a><span class="sd">    - Time histories (Not Implemented)</span>
</span><span id="Plotter_Class-320"><a href="#Plotter_Class-320"><span class="linenos">320</span></a><span class="sd">    - spectrums (Not Implemented)</span>
</span><span id="Plotter_Class-321"><a href="#Plotter_Class-321"><span class="linenos">321</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Plotter_Class-322"><a href="#Plotter_Class-322"><span class="linenos">322</span></a>
</span><span id="Plotter_Class-323"><a href="#Plotter_Class-323"><span class="linenos">323</span></a>    <span class="c1"># def __init__(self):</span>
</span><span id="Plotter_Class-324"><a href="#Plotter_Class-324"><span class="linenos">324</span></a>    <span class="c1">#     &quot;&quot;&quot;Reuse original self object.&quot;&quot;&quot;</span>
</span><span id="Plotter_Class-325"><a href="#Plotter_Class-325"><span class="linenos">325</span></a>    <span class="c1">#     super.__init__()</span>
</span><span id="Plotter_Class-326"><a href="#Plotter_Class-326"><span class="linenos">326</span></a>
</span><span id="Plotter_Class-327"><a href="#Plotter_Class-327"><span class="linenos">327</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Plotter_Class-328"><a href="#Plotter_Class-328"><span class="linenos">328</span></a>    <span class="k">def</span> <span class="nf">plot_signal_all_doms</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">filt_func</span><span class="o">=</span><span class="n">filter_Butter_default</span><span class="p">):</span>
</span><span id="Plotter_Class-329"><a href="#Plotter_Class-329"><span class="linenos">329</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot a coprehensive and analytical figure with the signal info.</span>
</span><span id="Plotter_Class-330"><a href="#Plotter_Class-330"><span class="linenos">330</span></a>
</span><span id="Plotter_Class-331"><a href="#Plotter_Class-331"><span class="linenos">331</span></a><span class="sd">        Construct a GraphicsLayoutWidget and place many graphs in it.</span>
</span><span id="Plotter_Class-332"><a href="#Plotter_Class-332"><span class="linenos">332</span></a><span class="sd">        - Raw and filtered signal in first row</span>
</span><span id="Plotter_Class-333"><a href="#Plotter_Class-333"><span class="linenos">333</span></a><span class="sd">            - filtering with</span>
</span><span id="Plotter_Class-334"><a href="#Plotter_Class-334"><span class="linenos">334</span></a><span class="sd">                - butterworth IIR filter</span>
</span><span id="Plotter_Class-335"><a href="#Plotter_Class-335"><span class="linenos">335</span></a><span class="sd">                - simple FIR filter</span>
</span><span id="Plotter_Class-336"><a href="#Plotter_Class-336"><span class="linenos">336</span></a>
</span><span id="Plotter_Class-337"><a href="#Plotter_Class-337"><span class="linenos">337</span></a><span class="sd">        - frequency domain of the filtered fignal</span>
</span><span id="Plotter_Class-338"><a href="#Plotter_Class-338"><span class="linenos">338</span></a><span class="sd">            - using fft algorithm</span>
</span><span id="Plotter_Class-339"><a href="#Plotter_Class-339"><span class="linenos">339</span></a><span class="sd">        - Spectral density of the filtered signal</span>
</span><span id="Plotter_Class-340"><a href="#Plotter_Class-340"><span class="linenos">340</span></a><span class="sd">            - with Welch&#39;s method</span>
</span><span id="Plotter_Class-341"><a href="#Plotter_Class-341"><span class="linenos">341</span></a><span class="sd">        Parameters</span>
</span><span id="Plotter_Class-342"><a href="#Plotter_Class-342"><span class="linenos">342</span></a><span class="sd">        ---</span>
</span><span id="Plotter_Class-343"><a href="#Plotter_Class-343"><span class="linenos">343</span></a><span class="sd">        - signal:</span>
</span><span id="Plotter_Class-344"><a href="#Plotter_Class-344"><span class="linenos">344</span></a><span class="sd">            - WT_NoiseChannelProc object</span>
</span><span id="Plotter_Class-345"><a href="#Plotter_Class-345"><span class="linenos">345</span></a>
</span><span id="Plotter_Class-346"><a href="#Plotter_Class-346"><span class="linenos">346</span></a><span class="sd">        Returns</span>
</span><span id="Plotter_Class-347"><a href="#Plotter_Class-347"><span class="linenos">347</span></a><span class="sd">        ---</span>
</span><span id="Plotter_Class-348"><a href="#Plotter_Class-348"><span class="linenos">348</span></a><span class="sd">        - win:</span>
</span><span id="Plotter_Class-349"><a href="#Plotter_Class-349"><span class="linenos">349</span></a><span class="sd">            - GraphicsLayoutWidget.GraphicsLayoutWidget object</span>
</span><span id="Plotter_Class-350"><a href="#Plotter_Class-350"><span class="linenos">350</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plotter_Class-351"><a href="#Plotter_Class-351"><span class="linenos">351</span></a>        <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">signals</span><span class="p">:</span>
</span><span id="Plotter_Class-352"><a href="#Plotter_Class-352"><span class="linenos">352</span></a>            <span class="n">filtrd</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">fc_Hz</span><span class="o">=</span><span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;fc_Hz&#39;</span><span class="p">],</span>
</span><span id="Plotter_Class-353"><a href="#Plotter_Class-353"><span class="linenos">353</span></a>                                 <span class="n">filter_func</span><span class="o">=</span><span class="n">filt_func</span><span class="p">)</span>
</span><span id="Plotter_Class-354"><a href="#Plotter_Class-354"><span class="linenos">354</span></a>
</span><span id="Plotter_Class-355"><a href="#Plotter_Class-355"><span class="linenos">355</span></a>            <span class="c1"># make a nice legend for filtered plot</span>
</span><span id="Plotter_Class-356"><a href="#Plotter_Class-356"><span class="linenos">356</span></a>            <span class="k">if</span> <span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;filter order&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">:</span>
</span><span id="Plotter_Class-357"><a href="#Plotter_Class-357"><span class="linenos">357</span></a>                <span class="n">filtrd</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="Plotter_Class-358"><a href="#Plotter_Class-358"><span class="linenos">358</span></a>                    <span class="sa">f</span><span class="s1">&#39;simple FIR low-pass </span><span class="si">{</span><span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;fc_Hz&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
</span><span id="Plotter_Class-359"><a href="#Plotter_Class-359"><span class="linenos">359</span></a>            <span class="k">elif</span> <span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;filter order&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">:</span>
</span><span id="Plotter_Class-360"><a href="#Plotter_Class-360"><span class="linenos">360</span></a>                <span class="n">filtrd</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="Plotter_Class-361"><a href="#Plotter_Class-361"><span class="linenos">361</span></a>                    <span class="sa">f</span><span class="s1">&#39;butterworth IIR low-pass </span><span class="si">{</span><span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;fc_Hz&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
</span><span id="Plotter_Class-362"><a href="#Plotter_Class-362"><span class="linenos">362</span></a>
</span><span id="Plotter_Class-363"><a href="#Plotter_Class-363"><span class="linenos">363</span></a>            <span class="n">freq_dom_filtrd</span> <span class="o">=</span> <span class="n">FFT_new</span><span class="p">(</span><span class="n">filtrd</span><span class="p">,</span>
</span><span id="Plotter_Class-364"><a href="#Plotter_Class-364"><span class="linenos">364</span></a>                                      <span class="n">title</span><span class="o">=</span>
</span><span id="Plotter_Class-365"><a href="#Plotter_Class-365"><span class="linenos">365</span></a>                                      <span class="sa">f</span><span class="s2">&quot;Time domain filtered with </span><span class="si">{</span><span class="n">filtrd</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Plotter_Class-366"><a href="#Plotter_Class-366"><span class="linenos">366</span></a>            <span class="n">win</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">GraphicsLayoutWidget</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Plotter_Class-367"><a href="#Plotter_Class-367"><span class="linenos">367</span></a>                                          <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Basic plotting examples&quot;</span><span class="p">)</span>
</span><span id="Plotter_Class-368"><a href="#Plotter_Class-368"><span class="linenos">368</span></a>            <span class="n">win</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">)</span>
</span><span id="Plotter_Class-369"><a href="#Plotter_Class-369"><span class="linenos">369</span></a>            <span class="n">win</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;pyqtgraph example: Plotting&#39;</span><span class="p">)</span>
</span><span id="Plotter_Class-370"><a href="#Plotter_Class-370"><span class="linenos">370</span></a>            <span class="c1"># Enable antialiasing for prettier plots</span>
</span><span id="Plotter_Class-371"><a href="#Plotter_Class-371"><span class="linenos">371</span></a>            <span class="n">pg</span><span class="o">.</span><span class="n">setConfigOptions</span><span class="p">(</span><span class="n">antialias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plotter_Class-372"><a href="#Plotter_Class-372"><span class="linenos">372</span></a>
</span><span id="Plotter_Class-373"><a href="#Plotter_Class-373"><span class="linenos">373</span></a>            <span class="n">p1_raw</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">addPlot</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Plotter_Class-374"><a href="#Plotter_Class-374"><span class="linenos">374</span></a>                                 <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Plotter_Class-375"><a href="#Plotter_Class-375"><span class="linenos">375</span></a>                                 <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Plotter_Class-376"><a href="#Plotter_Class-376"><span class="linenos">376</span></a>                                 <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">each</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">(m/s)&quot;</span><span class="p">)</span>
</span><span id="Plotter_Class-377"><a href="#Plotter_Class-377"><span class="linenos">377</span></a>            <span class="n">p1_raw</span><span class="o">.</span><span class="n">setLabels</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;time duration (s)&#39;</span><span class="p">,</span>
</span><span id="Plotter_Class-378"><a href="#Plotter_Class-378"><span class="linenos">378</span></a>                             <span class="n">left</span><span class="o">=</span><span class="s1">&#39;Raw sensor Voltage&#39;</span><span class="p">,)</span>
</span><span id="Plotter_Class-379"><a href="#Plotter_Class-379"><span class="linenos">379</span></a>
</span><span id="Plotter_Class-380"><a href="#Plotter_Class-380"><span class="linenos">380</span></a>            <span class="n">p1_raw</span><span class="o">.</span><span class="n">showGrid</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plotter_Class-381"><a href="#Plotter_Class-381"><span class="linenos">381</span></a>            <span class="n">p1_raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_dom_filtrd</span><span class="o">.</span><span class="n">time_sec</span><span class="p">,</span>
</span><span id="Plotter_Class-382"><a href="#Plotter_Class-382"><span class="linenos">382</span></a>                        <span class="n">each</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
</span><span id="Plotter_Class-383"><a href="#Plotter_Class-383"><span class="linenos">383</span></a>                        <span class="n">pen</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
</span><span id="Plotter_Class-384"><a href="#Plotter_Class-384"><span class="linenos">384</span></a>                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Raw signal&quot;</span><span class="p">)</span>
</span><span id="Plotter_Class-385"><a href="#Plotter_Class-385"><span class="linenos">385</span></a>
</span><span id="Plotter_Class-386"><a href="#Plotter_Class-386"><span class="linenos">386</span></a>            <span class="n">p1_filt</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">addPlot</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Plotter_Class-387"><a href="#Plotter_Class-387"><span class="linenos">387</span></a>                                  <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Plotter_Class-388"><a href="#Plotter_Class-388"><span class="linenos">388</span></a>                                  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Filtered signal&#39;</span><span class="p">)</span>
</span><span id="Plotter_Class-389"><a href="#Plotter_Class-389"><span class="linenos">389</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">setLabels</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;time duration (s)&#39;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Plotter_Class-390"><a href="#Plotter_Class-390"><span class="linenos">390</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">showGrid</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plotter_Class-391"><a href="#Plotter_Class-391"><span class="linenos">391</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">addLegend</span><span class="p">()</span>
</span><span id="Plotter_Class-392"><a href="#Plotter_Class-392"><span class="linenos">392</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">setYRange</span><span class="p">(</span><span class="n">filtrd</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="Plotter_Class-393"><a href="#Plotter_Class-393"><span class="linenos">393</span></a>                              <span class="n">filtrd</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>
</span><span id="Plotter_Class-394"><a href="#Plotter_Class-394"><span class="linenos">394</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_dom_filtrd</span><span class="o">.</span><span class="n">time_sec</span><span class="p">,</span>
</span><span id="Plotter_Class-395"><a href="#Plotter_Class-395"><span class="linenos">395</span></a>                         <span class="n">filtrd</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
</span><span id="Plotter_Class-396"><a href="#Plotter_Class-396"><span class="linenos">396</span></a>                         <span class="n">pen</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
</span><span id="Plotter_Class-397"><a href="#Plotter_Class-397"><span class="linenos">397</span></a>                         <span class="n">name</span><span class="o">=</span><span class="p">(</span>
</span><span id="Plotter_Class-398"><a href="#Plotter_Class-398"><span class="linenos">398</span></a>                             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filtrd</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
</span><span id="Plotter_Class-399"><a href="#Plotter_Class-399"><span class="linenos">399</span></a>
</span><span id="Plotter_Class-400"><a href="#Plotter_Class-400"><span class="linenos">400</span></a>            <span class="n">p2_filt_fft</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">addPlot</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Plotter_Class-401"><a href="#Plotter_Class-401"><span class="linenos">401</span></a>                                      <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Plotter_Class-402"><a href="#Plotter_Class-402"><span class="linenos">402</span></a>                                      <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Plotter_Class-403"><a href="#Plotter_Class-403"><span class="linenos">403</span></a>                                      <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Plotter_Class-404"><a href="#Plotter_Class-404"><span class="linenos">404</span></a>                                      <span class="n">padding</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Plotter_Class-405"><a href="#Plotter_Class-405"><span class="linenos">405</span></a>                                      <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Filtered signal Frequency domain representation&quot;</span><span class="p">)</span>
</span><span id="Plotter_Class-406"><a href="#Plotter_Class-406"><span class="linenos">406</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">freq_dom_filtrd</span><span class="o">.</span><span class="n">fft_calc</span><span class="p">()</span>
</span><span id="Plotter_Class-407"><a href="#Plotter_Class-407"><span class="linenos">407</span></a>            <span class="n">p2_filt_fft</span><span class="o">.</span><span class="n">setLogMode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plotter_Class-408"><a href="#Plotter_Class-408"><span class="linenos">408</span></a>            <span class="n">p2_filt_fft</span><span class="o">.</span><span class="n">showGrid</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plotter_Class-409"><a href="#Plotter_Class-409"><span class="linenos">409</span></a>            <span class="n">p2_filt_fft</span><span class="o">.</span><span class="n">setLabels</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;Frequencies in Hz&#39;</span><span class="p">,</span>
</span><span id="Plotter_Class-410"><a href="#Plotter_Class-410"><span class="linenos">410</span></a>                                  <span class="n">left</span><span class="o">=</span><span class="s1">&#39;Power/Freq&#39;</span><span class="p">,</span>
</span><span id="Plotter_Class-411"><a href="#Plotter_Class-411"><span class="linenos">411</span></a>                                  <span class="n">top</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Plotter_Class-412"><a href="#Plotter_Class-412"><span class="linenos">412</span></a>            <span class="c1"># p2.setLabel(axis=&#39;bottom&#39;, text=&#39;Frequencies in Hz&#39;)</span>
</span><span id="Plotter_Class-413"><a href="#Plotter_Class-413"><span class="linenos">413</span></a>            <span class="c1"># p2.setLabel(axis=&#39;left&#39;, text=&#39;Power/Freq&#39;)</span>
</span><span id="Plotter_Class-414"><a href="#Plotter_Class-414"><span class="linenos">414</span></a>            <span class="n">p2_filt_fft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="Plotter_Class-415"><a href="#Plotter_Class-415"><span class="linenos">415</span></a>                             <span class="n">pen</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span>
</span><span id="Plotter_Class-416"><a href="#Plotter_Class-416"><span class="linenos">416</span></a>                             <span class="n">fillLevel</span><span class="o">=-</span><span class="mi">18</span><span class="p">,</span>
</span><span id="Plotter_Class-417"><a href="#Plotter_Class-417"><span class="linenos">417</span></a>                             <span class="n">brush</span><span class="o">=</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</span><span id="Plotter_Class-418"><a href="#Plotter_Class-418"><span class="linenos">418</span></a>
</span><span id="Plotter_Class-419"><a href="#Plotter_Class-419"><span class="linenos">419</span></a>            <span class="n">p3_filt_spect</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">addPlot</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Plotter_Class-420"><a href="#Plotter_Class-420"><span class="linenos">420</span></a>                                        <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Plotter_Class-421"><a href="#Plotter_Class-421"><span class="linenos">421</span></a>                                        <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Plotter_Class-422"><a href="#Plotter_Class-422"><span class="linenos">422</span></a>                                        <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Plotter_Class-423"><a href="#Plotter_Class-423"><span class="linenos">423</span></a>                                        <span class="n">padding</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Plotter_Class-424"><a href="#Plotter_Class-424"><span class="linenos">424</span></a>                                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Filtered signal Spectral density (welch)&quot;</span><span class="p">)</span>
</span><span id="Plotter_Class-425"><a href="#Plotter_Class-425"><span class="linenos">425</span></a>            <span class="n">welch</span> <span class="o">=</span> <span class="n">filtrd</span><span class="o">.</span><span class="n">calc_spectrum_gen</span><span class="p">(</span><span class="n">nperseg</span><span class="o">=</span><span class="mi">1024</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span>
</span><span id="Plotter_Class-426"><a href="#Plotter_Class-426"><span class="linenos">426</span></a>            <span class="n">p3_filt_spect</span><span class="o">.</span><span class="n">setLogMode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plotter_Class-427"><a href="#Plotter_Class-427"><span class="linenos">427</span></a>            <span class="n">p3_filt_spect</span><span class="o">.</span><span class="n">showGrid</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plotter_Class-428"><a href="#Plotter_Class-428"><span class="linenos">428</span></a>            <span class="n">p3_filt_spect</span><span class="o">.</span><span class="n">setLabels</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;Frequencies in Hz&#39;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;dB&#39;</span><span class="p">,</span>
</span><span id="Plotter_Class-429"><a href="#Plotter_Class-429"><span class="linenos">429</span></a>                                    <span class="n">top</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Plotter_Class-430"><a href="#Plotter_Class-430"><span class="linenos">430</span></a>            <span class="c1"># p3_filt_spect.setYRange(-5, -18)</span>
</span><span id="Plotter_Class-431"><a href="#Plotter_Class-431"><span class="linenos">431</span></a>            <span class="c1"># p2.setLabel(axis=&#39;bottom&#39;, text=&#39;Frequencies in Hz&#39;)</span>
</span><span id="Plotter_Class-432"><a href="#Plotter_Class-432"><span class="linenos">432</span></a>            <span class="c1"># p2.setLabel(axis=&#39;left&#39;, text=&#39;Power/Freq&#39;)</span>
</span><span id="Plotter_Class-433"><a href="#Plotter_Class-433"><span class="linenos">433</span></a>            <span class="n">p3_filt_spect</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">welch</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">welch</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="Plotter_Class-434"><a href="#Plotter_Class-434"><span class="linenos">434</span></a>                               <span class="n">pen</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span>
</span><span id="Plotter_Class-435"><a href="#Plotter_Class-435"><span class="linenos">435</span></a>                               <span class="n">fillLevel</span><span class="o">=-</span><span class="mi">18</span><span class="p">,</span>
</span><span id="Plotter_Class-436"><a href="#Plotter_Class-436"><span class="linenos">436</span></a>                               <span class="n">brush</span><span class="o">=</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</span><span id="Plotter_Class-437"><a href="#Plotter_Class-437"><span class="linenos">437</span></a>
</span><span id="Plotter_Class-438"><a href="#Plotter_Class-438"><span class="linenos">438</span></a>            <span class="c1"># save to a file somewhere</span>
</span><span id="Plotter_Class-439"><a href="#Plotter_Class-439"><span class="linenos">439</span></a>            <span class="n">exporter</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">exporters</span><span class="o">.</span><span class="n">ImageExporter</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">scene</span><span class="p">())</span>
</span><span id="Plotter_Class-440"><a href="#Plotter_Class-440"><span class="linenos">440</span></a>            <span class="n">exporter</span><span class="o">.</span><span class="n">parameters</span><span class="p">()[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1920</span>   <span class="c1"># also effects the height</span>
</span><span id="Plotter_Class-441"><a href="#Plotter_Class-441"><span class="linenos">441</span></a>            <span class="n">exporter</span><span class="o">.</span><span class="n">parameters</span><span class="p">()[</span><span class="s1">&#39;antialias&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Plotter_Class-442"><a href="#Plotter_Class-442"><span class="linenos">442</span></a>            <span class="c1"># exporter.export(&#39;./sig_proc_plots/test.jpg&#39;)</span>
</span><span id="Plotter_Class-443"><a href="#Plotter_Class-443"><span class="linenos">443</span></a>            <span class="c1"># print(&quot;1&quot;)</span>
</span><span id="Plotter_Class-444"><a href="#Plotter_Class-444"><span class="linenos">444</span></a>            <span class="n">pg</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>
</span><span id="Plotter_Class-445"><a href="#Plotter_Class-445"><span class="linenos">445</span></a>
</span><span id="Plotter_Class-446"><a href="#Plotter_Class-446"><span class="linenos">446</span></a>            <span class="c1"># pass</span>
</span></pre></div>


            <div class="docstring"><h1 id="this-is-a-class-that-can-take-different-objects-for-plotting">This is a class that can take different objects for plotting.</h1>

<p>Takes their raw data and plots:</p>

<ul>
<li>a overview for the signal in frequency and time domains</li>
<li>Time histories (Not Implemented)</li>
<li>spectrums (Not Implemented)</li>
</ul>
</div>


                            <div id="Plotter_Class.plot_signal_all_doms" class="classattr">
                                        <input id="Plotter_Class.plot_signal_all_doms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">plot_signal_all_doms</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">signals</span>,</span><span class="param">	<span class="n">filt_func</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">filt_butter_factory</span><span class="o">.&lt;</span><span class="nb">locals</span><span class="o">&gt;.</span><span class="n">filt_butter</span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plotter_Class.plot_signal_all_doms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plotter_Class.plot_signal_all_doms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plotter_Class.plot_signal_all_doms-327"><a href="#Plotter_Class.plot_signal_all_doms-327"><span class="linenos">327</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Plotter_Class.plot_signal_all_doms-328"><a href="#Plotter_Class.plot_signal_all_doms-328"><span class="linenos">328</span></a>    <span class="k">def</span> <span class="nf">plot_signal_all_doms</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">filt_func</span><span class="o">=</span><span class="n">filter_Butter_default</span><span class="p">):</span>
</span><span id="Plotter_Class.plot_signal_all_doms-329"><a href="#Plotter_Class.plot_signal_all_doms-329"><span class="linenos">329</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot a coprehensive and analytical figure with the signal info.</span>
</span><span id="Plotter_Class.plot_signal_all_doms-330"><a href="#Plotter_Class.plot_signal_all_doms-330"><span class="linenos">330</span></a>
</span><span id="Plotter_Class.plot_signal_all_doms-331"><a href="#Plotter_Class.plot_signal_all_doms-331"><span class="linenos">331</span></a><span class="sd">        Construct a GraphicsLayoutWidget and place many graphs in it.</span>
</span><span id="Plotter_Class.plot_signal_all_doms-332"><a href="#Plotter_Class.plot_signal_all_doms-332"><span class="linenos">332</span></a><span class="sd">        - Raw and filtered signal in first row</span>
</span><span id="Plotter_Class.plot_signal_all_doms-333"><a href="#Plotter_Class.plot_signal_all_doms-333"><span class="linenos">333</span></a><span class="sd">            - filtering with</span>
</span><span id="Plotter_Class.plot_signal_all_doms-334"><a href="#Plotter_Class.plot_signal_all_doms-334"><span class="linenos">334</span></a><span class="sd">                - butterworth IIR filter</span>
</span><span id="Plotter_Class.plot_signal_all_doms-335"><a href="#Plotter_Class.plot_signal_all_doms-335"><span class="linenos">335</span></a><span class="sd">                - simple FIR filter</span>
</span><span id="Plotter_Class.plot_signal_all_doms-336"><a href="#Plotter_Class.plot_signal_all_doms-336"><span class="linenos">336</span></a>
</span><span id="Plotter_Class.plot_signal_all_doms-337"><a href="#Plotter_Class.plot_signal_all_doms-337"><span class="linenos">337</span></a><span class="sd">        - frequency domain of the filtered fignal</span>
</span><span id="Plotter_Class.plot_signal_all_doms-338"><a href="#Plotter_Class.plot_signal_all_doms-338"><span class="linenos">338</span></a><span class="sd">            - using fft algorithm</span>
</span><span id="Plotter_Class.plot_signal_all_doms-339"><a href="#Plotter_Class.plot_signal_all_doms-339"><span class="linenos">339</span></a><span class="sd">        - Spectral density of the filtered signal</span>
</span><span id="Plotter_Class.plot_signal_all_doms-340"><a href="#Plotter_Class.plot_signal_all_doms-340"><span class="linenos">340</span></a><span class="sd">            - with Welch&#39;s method</span>
</span><span id="Plotter_Class.plot_signal_all_doms-341"><a href="#Plotter_Class.plot_signal_all_doms-341"><span class="linenos">341</span></a><span class="sd">        Parameters</span>
</span><span id="Plotter_Class.plot_signal_all_doms-342"><a href="#Plotter_Class.plot_signal_all_doms-342"><span class="linenos">342</span></a><span class="sd">        ---</span>
</span><span id="Plotter_Class.plot_signal_all_doms-343"><a href="#Plotter_Class.plot_signal_all_doms-343"><span class="linenos">343</span></a><span class="sd">        - signal:</span>
</span><span id="Plotter_Class.plot_signal_all_doms-344"><a href="#Plotter_Class.plot_signal_all_doms-344"><span class="linenos">344</span></a><span class="sd">            - WT_NoiseChannelProc object</span>
</span><span id="Plotter_Class.plot_signal_all_doms-345"><a href="#Plotter_Class.plot_signal_all_doms-345"><span class="linenos">345</span></a>
</span><span id="Plotter_Class.plot_signal_all_doms-346"><a href="#Plotter_Class.plot_signal_all_doms-346"><span class="linenos">346</span></a><span class="sd">        Returns</span>
</span><span id="Plotter_Class.plot_signal_all_doms-347"><a href="#Plotter_Class.plot_signal_all_doms-347"><span class="linenos">347</span></a><span class="sd">        ---</span>
</span><span id="Plotter_Class.plot_signal_all_doms-348"><a href="#Plotter_Class.plot_signal_all_doms-348"><span class="linenos">348</span></a><span class="sd">        - win:</span>
</span><span id="Plotter_Class.plot_signal_all_doms-349"><a href="#Plotter_Class.plot_signal_all_doms-349"><span class="linenos">349</span></a><span class="sd">            - GraphicsLayoutWidget.GraphicsLayoutWidget object</span>
</span><span id="Plotter_Class.plot_signal_all_doms-350"><a href="#Plotter_Class.plot_signal_all_doms-350"><span class="linenos">350</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plotter_Class.plot_signal_all_doms-351"><a href="#Plotter_Class.plot_signal_all_doms-351"><span class="linenos">351</span></a>        <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">signals</span><span class="p">:</span>
</span><span id="Plotter_Class.plot_signal_all_doms-352"><a href="#Plotter_Class.plot_signal_all_doms-352"><span class="linenos">352</span></a>            <span class="n">filtrd</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">fc_Hz</span><span class="o">=</span><span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;fc_Hz&#39;</span><span class="p">],</span>
</span><span id="Plotter_Class.plot_signal_all_doms-353"><a href="#Plotter_Class.plot_signal_all_doms-353"><span class="linenos">353</span></a>                                 <span class="n">filter_func</span><span class="o">=</span><span class="n">filt_func</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-354"><a href="#Plotter_Class.plot_signal_all_doms-354"><span class="linenos">354</span></a>
</span><span id="Plotter_Class.plot_signal_all_doms-355"><a href="#Plotter_Class.plot_signal_all_doms-355"><span class="linenos">355</span></a>            <span class="c1"># make a nice legend for filtered plot</span>
</span><span id="Plotter_Class.plot_signal_all_doms-356"><a href="#Plotter_Class.plot_signal_all_doms-356"><span class="linenos">356</span></a>            <span class="k">if</span> <span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;filter order&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">:</span>
</span><span id="Plotter_Class.plot_signal_all_doms-357"><a href="#Plotter_Class.plot_signal_all_doms-357"><span class="linenos">357</span></a>                <span class="n">filtrd</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="Plotter_Class.plot_signal_all_doms-358"><a href="#Plotter_Class.plot_signal_all_doms-358"><span class="linenos">358</span></a>                    <span class="sa">f</span><span class="s1">&#39;simple FIR low-pass </span><span class="si">{</span><span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;fc_Hz&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-359"><a href="#Plotter_Class.plot_signal_all_doms-359"><span class="linenos">359</span></a>            <span class="k">elif</span> <span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;filter order&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">:</span>
</span><span id="Plotter_Class.plot_signal_all_doms-360"><a href="#Plotter_Class.plot_signal_all_doms-360"><span class="linenos">360</span></a>                <span class="n">filtrd</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="Plotter_Class.plot_signal_all_doms-361"><a href="#Plotter_Class.plot_signal_all_doms-361"><span class="linenos">361</span></a>                    <span class="sa">f</span><span class="s1">&#39;butterworth IIR low-pass </span><span class="si">{</span><span class="n">filt_func</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;fc_Hz&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-362"><a href="#Plotter_Class.plot_signal_all_doms-362"><span class="linenos">362</span></a>
</span><span id="Plotter_Class.plot_signal_all_doms-363"><a href="#Plotter_Class.plot_signal_all_doms-363"><span class="linenos">363</span></a>            <span class="n">freq_dom_filtrd</span> <span class="o">=</span> <span class="n">FFT_new</span><span class="p">(</span><span class="n">filtrd</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-364"><a href="#Plotter_Class.plot_signal_all_doms-364"><span class="linenos">364</span></a>                                      <span class="n">title</span><span class="o">=</span>
</span><span id="Plotter_Class.plot_signal_all_doms-365"><a href="#Plotter_Class.plot_signal_all_doms-365"><span class="linenos">365</span></a>                                      <span class="sa">f</span><span class="s2">&quot;Time domain filtered with </span><span class="si">{</span><span class="n">filtrd</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-366"><a href="#Plotter_Class.plot_signal_all_doms-366"><span class="linenos">366</span></a>            <span class="n">win</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">GraphicsLayoutWidget</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-367"><a href="#Plotter_Class.plot_signal_all_doms-367"><span class="linenos">367</span></a>                                          <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Basic plotting examples&quot;</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-368"><a href="#Plotter_Class.plot_signal_all_doms-368"><span class="linenos">368</span></a>            <span class="n">win</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-369"><a href="#Plotter_Class.plot_signal_all_doms-369"><span class="linenos">369</span></a>            <span class="n">win</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;pyqtgraph example: Plotting&#39;</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-370"><a href="#Plotter_Class.plot_signal_all_doms-370"><span class="linenos">370</span></a>            <span class="c1"># Enable antialiasing for prettier plots</span>
</span><span id="Plotter_Class.plot_signal_all_doms-371"><a href="#Plotter_Class.plot_signal_all_doms-371"><span class="linenos">371</span></a>            <span class="n">pg</span><span class="o">.</span><span class="n">setConfigOptions</span><span class="p">(</span><span class="n">antialias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-372"><a href="#Plotter_Class.plot_signal_all_doms-372"><span class="linenos">372</span></a>
</span><span id="Plotter_Class.plot_signal_all_doms-373"><a href="#Plotter_Class.plot_signal_all_doms-373"><span class="linenos">373</span></a>            <span class="n">p1_raw</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">addPlot</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-374"><a href="#Plotter_Class.plot_signal_all_doms-374"><span class="linenos">374</span></a>                                 <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-375"><a href="#Plotter_Class.plot_signal_all_doms-375"><span class="linenos">375</span></a>                                 <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-376"><a href="#Plotter_Class.plot_signal_all_doms-376"><span class="linenos">376</span></a>                                 <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">each</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">(m/s)&quot;</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-377"><a href="#Plotter_Class.plot_signal_all_doms-377"><span class="linenos">377</span></a>            <span class="n">p1_raw</span><span class="o">.</span><span class="n">setLabels</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;time duration (s)&#39;</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-378"><a href="#Plotter_Class.plot_signal_all_doms-378"><span class="linenos">378</span></a>                             <span class="n">left</span><span class="o">=</span><span class="s1">&#39;Raw sensor Voltage&#39;</span><span class="p">,)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-379"><a href="#Plotter_Class.plot_signal_all_doms-379"><span class="linenos">379</span></a>
</span><span id="Plotter_Class.plot_signal_all_doms-380"><a href="#Plotter_Class.plot_signal_all_doms-380"><span class="linenos">380</span></a>            <span class="n">p1_raw</span><span class="o">.</span><span class="n">showGrid</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-381"><a href="#Plotter_Class.plot_signal_all_doms-381"><span class="linenos">381</span></a>            <span class="n">p1_raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_dom_filtrd</span><span class="o">.</span><span class="n">time_sec</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-382"><a href="#Plotter_Class.plot_signal_all_doms-382"><span class="linenos">382</span></a>                        <span class="n">each</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-383"><a href="#Plotter_Class.plot_signal_all_doms-383"><span class="linenos">383</span></a>                        <span class="n">pen</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
</span><span id="Plotter_Class.plot_signal_all_doms-384"><a href="#Plotter_Class.plot_signal_all_doms-384"><span class="linenos">384</span></a>                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Raw signal&quot;</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-385"><a href="#Plotter_Class.plot_signal_all_doms-385"><span class="linenos">385</span></a>
</span><span id="Plotter_Class.plot_signal_all_doms-386"><a href="#Plotter_Class.plot_signal_all_doms-386"><span class="linenos">386</span></a>            <span class="n">p1_filt</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">addPlot</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-387"><a href="#Plotter_Class.plot_signal_all_doms-387"><span class="linenos">387</span></a>                                  <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-388"><a href="#Plotter_Class.plot_signal_all_doms-388"><span class="linenos">388</span></a>                                  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Filtered signal&#39;</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-389"><a href="#Plotter_Class.plot_signal_all_doms-389"><span class="linenos">389</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">setLabels</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;time duration (s)&#39;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-390"><a href="#Plotter_Class.plot_signal_all_doms-390"><span class="linenos">390</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">showGrid</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-391"><a href="#Plotter_Class.plot_signal_all_doms-391"><span class="linenos">391</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">addLegend</span><span class="p">()</span>
</span><span id="Plotter_Class.plot_signal_all_doms-392"><a href="#Plotter_Class.plot_signal_all_doms-392"><span class="linenos">392</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">setYRange</span><span class="p">(</span><span class="n">filtrd</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-393"><a href="#Plotter_Class.plot_signal_all_doms-393"><span class="linenos">393</span></a>                              <span class="n">filtrd</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-394"><a href="#Plotter_Class.plot_signal_all_doms-394"><span class="linenos">394</span></a>            <span class="n">p1_filt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_dom_filtrd</span><span class="o">.</span><span class="n">time_sec</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-395"><a href="#Plotter_Class.plot_signal_all_doms-395"><span class="linenos">395</span></a>                         <span class="n">filtrd</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-396"><a href="#Plotter_Class.plot_signal_all_doms-396"><span class="linenos">396</span></a>                         <span class="n">pen</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
</span><span id="Plotter_Class.plot_signal_all_doms-397"><a href="#Plotter_Class.plot_signal_all_doms-397"><span class="linenos">397</span></a>                         <span class="n">name</span><span class="o">=</span><span class="p">(</span>
</span><span id="Plotter_Class.plot_signal_all_doms-398"><a href="#Plotter_Class.plot_signal_all_doms-398"><span class="linenos">398</span></a>                             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filtrd</span><span class="o">.</span><span class="n">operations</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
</span><span id="Plotter_Class.plot_signal_all_doms-399"><a href="#Plotter_Class.plot_signal_all_doms-399"><span class="linenos">399</span></a>
</span><span id="Plotter_Class.plot_signal_all_doms-400"><a href="#Plotter_Class.plot_signal_all_doms-400"><span class="linenos">400</span></a>            <span class="n">p2_filt_fft</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">addPlot</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-401"><a href="#Plotter_Class.plot_signal_all_doms-401"><span class="linenos">401</span></a>                                      <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-402"><a href="#Plotter_Class.plot_signal_all_doms-402"><span class="linenos">402</span></a>                                      <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-403"><a href="#Plotter_Class.plot_signal_all_doms-403"><span class="linenos">403</span></a>                                      <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-404"><a href="#Plotter_Class.plot_signal_all_doms-404"><span class="linenos">404</span></a>                                      <span class="n">padding</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-405"><a href="#Plotter_Class.plot_signal_all_doms-405"><span class="linenos">405</span></a>                                      <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Filtered signal Frequency domain representation&quot;</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-406"><a href="#Plotter_Class.plot_signal_all_doms-406"><span class="linenos">406</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">freq_dom_filtrd</span><span class="o">.</span><span class="n">fft_calc</span><span class="p">()</span>
</span><span id="Plotter_Class.plot_signal_all_doms-407"><a href="#Plotter_Class.plot_signal_all_doms-407"><span class="linenos">407</span></a>            <span class="n">p2_filt_fft</span><span class="o">.</span><span class="n">setLogMode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-408"><a href="#Plotter_Class.plot_signal_all_doms-408"><span class="linenos">408</span></a>            <span class="n">p2_filt_fft</span><span class="o">.</span><span class="n">showGrid</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-409"><a href="#Plotter_Class.plot_signal_all_doms-409"><span class="linenos">409</span></a>            <span class="n">p2_filt_fft</span><span class="o">.</span><span class="n">setLabels</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;Frequencies in Hz&#39;</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-410"><a href="#Plotter_Class.plot_signal_all_doms-410"><span class="linenos">410</span></a>                                  <span class="n">left</span><span class="o">=</span><span class="s1">&#39;Power/Freq&#39;</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-411"><a href="#Plotter_Class.plot_signal_all_doms-411"><span class="linenos">411</span></a>                                  <span class="n">top</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-412"><a href="#Plotter_Class.plot_signal_all_doms-412"><span class="linenos">412</span></a>            <span class="c1"># p2.setLabel(axis=&#39;bottom&#39;, text=&#39;Frequencies in Hz&#39;)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-413"><a href="#Plotter_Class.plot_signal_all_doms-413"><span class="linenos">413</span></a>            <span class="c1"># p2.setLabel(axis=&#39;left&#39;, text=&#39;Power/Freq&#39;)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-414"><a href="#Plotter_Class.plot_signal_all_doms-414"><span class="linenos">414</span></a>            <span class="n">p2_filt_fft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-415"><a href="#Plotter_Class.plot_signal_all_doms-415"><span class="linenos">415</span></a>                             <span class="n">pen</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span>
</span><span id="Plotter_Class.plot_signal_all_doms-416"><a href="#Plotter_Class.plot_signal_all_doms-416"><span class="linenos">416</span></a>                             <span class="n">fillLevel</span><span class="o">=-</span><span class="mi">18</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-417"><a href="#Plotter_Class.plot_signal_all_doms-417"><span class="linenos">417</span></a>                             <span class="n">brush</span><span class="o">=</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</span><span id="Plotter_Class.plot_signal_all_doms-418"><a href="#Plotter_Class.plot_signal_all_doms-418"><span class="linenos">418</span></a>
</span><span id="Plotter_Class.plot_signal_all_doms-419"><a href="#Plotter_Class.plot_signal_all_doms-419"><span class="linenos">419</span></a>            <span class="n">p3_filt_spect</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">addPlot</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-420"><a href="#Plotter_Class.plot_signal_all_doms-420"><span class="linenos">420</span></a>                                        <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-421"><a href="#Plotter_Class.plot_signal_all_doms-421"><span class="linenos">421</span></a>                                        <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-422"><a href="#Plotter_Class.plot_signal_all_doms-422"><span class="linenos">422</span></a>                                        <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-423"><a href="#Plotter_Class.plot_signal_all_doms-423"><span class="linenos">423</span></a>                                        <span class="n">padding</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-424"><a href="#Plotter_Class.plot_signal_all_doms-424"><span class="linenos">424</span></a>                                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Filtered signal Spectral density (welch)&quot;</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-425"><a href="#Plotter_Class.plot_signal_all_doms-425"><span class="linenos">425</span></a>            <span class="n">welch</span> <span class="o">=</span> <span class="n">filtrd</span><span class="o">.</span><span class="n">calc_spectrum_gen</span><span class="p">(</span><span class="n">nperseg</span><span class="o">=</span><span class="mi">1024</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-426"><a href="#Plotter_Class.plot_signal_all_doms-426"><span class="linenos">426</span></a>            <span class="n">p3_filt_spect</span><span class="o">.</span><span class="n">setLogMode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-427"><a href="#Plotter_Class.plot_signal_all_doms-427"><span class="linenos">427</span></a>            <span class="n">p3_filt_spect</span><span class="o">.</span><span class="n">showGrid</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-428"><a href="#Plotter_Class.plot_signal_all_doms-428"><span class="linenos">428</span></a>            <span class="n">p3_filt_spect</span><span class="o">.</span><span class="n">setLabels</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="s1">&#39;Frequencies in Hz&#39;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="s1">&#39;dB&#39;</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-429"><a href="#Plotter_Class.plot_signal_all_doms-429"><span class="linenos">429</span></a>                                    <span class="n">top</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-430"><a href="#Plotter_Class.plot_signal_all_doms-430"><span class="linenos">430</span></a>            <span class="c1"># p3_filt_spect.setYRange(-5, -18)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-431"><a href="#Plotter_Class.plot_signal_all_doms-431"><span class="linenos">431</span></a>            <span class="c1"># p2.setLabel(axis=&#39;bottom&#39;, text=&#39;Frequencies in Hz&#39;)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-432"><a href="#Plotter_Class.plot_signal_all_doms-432"><span class="linenos">432</span></a>            <span class="c1"># p2.setLabel(axis=&#39;left&#39;, text=&#39;Power/Freq&#39;)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-433"><a href="#Plotter_Class.plot_signal_all_doms-433"><span class="linenos">433</span></a>            <span class="n">p3_filt_spect</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">welch</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">welch</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-434"><a href="#Plotter_Class.plot_signal_all_doms-434"><span class="linenos">434</span></a>                               <span class="n">pen</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span>
</span><span id="Plotter_Class.plot_signal_all_doms-435"><a href="#Plotter_Class.plot_signal_all_doms-435"><span class="linenos">435</span></a>                               <span class="n">fillLevel</span><span class="o">=-</span><span class="mi">18</span><span class="p">,</span>
</span><span id="Plotter_Class.plot_signal_all_doms-436"><a href="#Plotter_Class.plot_signal_all_doms-436"><span class="linenos">436</span></a>                               <span class="n">brush</span><span class="o">=</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</span><span id="Plotter_Class.plot_signal_all_doms-437"><a href="#Plotter_Class.plot_signal_all_doms-437"><span class="linenos">437</span></a>
</span><span id="Plotter_Class.plot_signal_all_doms-438"><a href="#Plotter_Class.plot_signal_all_doms-438"><span class="linenos">438</span></a>            <span class="c1"># save to a file somewhere</span>
</span><span id="Plotter_Class.plot_signal_all_doms-439"><a href="#Plotter_Class.plot_signal_all_doms-439"><span class="linenos">439</span></a>            <span class="n">exporter</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">exporters</span><span class="o">.</span><span class="n">ImageExporter</span><span class="p">(</span><span class="n">win</span><span class="o">.</span><span class="n">scene</span><span class="p">())</span>
</span><span id="Plotter_Class.plot_signal_all_doms-440"><a href="#Plotter_Class.plot_signal_all_doms-440"><span class="linenos">440</span></a>            <span class="n">exporter</span><span class="o">.</span><span class="n">parameters</span><span class="p">()[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1920</span>   <span class="c1"># also effects the height</span>
</span><span id="Plotter_Class.plot_signal_all_doms-441"><a href="#Plotter_Class.plot_signal_all_doms-441"><span class="linenos">441</span></a>            <span class="n">exporter</span><span class="o">.</span><span class="n">parameters</span><span class="p">()[</span><span class="s1">&#39;antialias&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Plotter_Class.plot_signal_all_doms-442"><a href="#Plotter_Class.plot_signal_all_doms-442"><span class="linenos">442</span></a>            <span class="c1"># exporter.export(&#39;./sig_proc_plots/test.jpg&#39;)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-443"><a href="#Plotter_Class.plot_signal_all_doms-443"><span class="linenos">443</span></a>            <span class="c1"># print(&quot;1&quot;)</span>
</span><span id="Plotter_Class.plot_signal_all_doms-444"><a href="#Plotter_Class.plot_signal_all_doms-444"><span class="linenos">444</span></a>            <span class="n">pg</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>
</span><span id="Plotter_Class.plot_signal_all_doms-445"><a href="#Plotter_Class.plot_signal_all_doms-445"><span class="linenos">445</span></a>
</span><span id="Plotter_Class.plot_signal_all_doms-446"><a href="#Plotter_Class.plot_signal_all_doms-446"><span class="linenos">446</span></a>            <span class="c1"># pass</span>
</span></pre></div>


            <div class="docstring"><p>Plot a coprehensive and analytical figure with the signal info.</p>

<p>Construct a GraphicsLayoutWidget and place many graphs in it.</p>

<ul>
<li>Raw and filtered signal in first row
<ul>
<li>filtering with
<ul>
<li>butterworth IIR filter</li>
<li>simple FIR filter</li>
</ul></li>
</ul></li>
</ul>

<ul>
<li>frequency domain of the filtered fignal
<ul>
<li>using fft algorithm</li>
</ul></li>
<li><p>Spectral density of the filtered signal</p>

<ul>
<li>with Welch's method
<h2 id="parameters">Parameters</h2></li>
</ul></li>
<li><p>signal:</p>

<ul>
<li>WT_NoiseChannelProc object</li>
</ul></li>
</ul>

<h2 id="returns">Returns</h2>

<ul>
<li>win:
<ul>
<li>GraphicsLayoutWidget.GraphicsLayoutWidget object</li>
</ul></li>
</ul>
</div>


                            </div>
                </section>
                <section id="plot_comparative_response">
                            <input id="plot_comparative_response-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_comparative_response</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">wt_obj</span>,</span><span class="param">	<span class="n">filter_func</span>,</span><span class="param">	<span class="n">response_offset</span><span class="o">=</span><span class="mf">0.0002</span>,</span><span class="param">	<span class="n">Kolmogorov_offset</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>,</span><span class="param">	<span class="n">nperseg</span><span class="o">=</span><span class="mi">1024</span>,</span><span class="param">	<span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">100000.0</span><span class="p">]</span>,</span><span class="param">	<span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-08</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>,</span><span class="param">	<span class="n">plot_th</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="plot_comparative_response-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#plot_comparative_response"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="plot_comparative_response-449"><a href="#plot_comparative_response-449"><span class="linenos">449</span></a><span class="k">def</span> <span class="nf">plot_comparative_response</span><span class="p">(</span><span class="n">wt_obj</span><span class="p">,</span>   <span class="c1"># cutoff frequency</span>
</span><span id="plot_comparative_response-450"><a href="#plot_comparative_response-450"><span class="linenos">450</span></a>                              <span class="n">filter_func</span><span class="p">,</span> <span class="n">response_offset</span><span class="o">=</span><span class="mf">2e-4</span><span class="p">,</span>
</span><span id="plot_comparative_response-451"><a href="#plot_comparative_response-451"><span class="linenos">451</span></a>                              <span class="n">Kolmogorov_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="plot_comparative_response-452"><a href="#plot_comparative_response-452"><span class="linenos">452</span></a>                              <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
</span><span id="plot_comparative_response-453"><a href="#plot_comparative_response-453"><span class="linenos">453</span></a>                              <span class="n">nperseg</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
</span><span id="plot_comparative_response-454"><a href="#plot_comparative_response-454"><span class="linenos">454</span></a>                              <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">1e1</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">],</span>
</span><span id="plot_comparative_response-455"><a href="#plot_comparative_response-455"><span class="linenos">455</span></a>                              <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">],</span>
</span><span id="plot_comparative_response-456"><a href="#plot_comparative_response-456"><span class="linenos">456</span></a>                              <span class="n">plot_th</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="plot_comparative_response-457"><a href="#plot_comparative_response-457"><span class="linenos">457</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;#TOD make this part of WT_NoiProc.</span>
</span><span id="plot_comparative_response-458"><a href="#plot_comparative_response-458"><span class="linenos">458</span></a>
</span><span id="plot_comparative_response-459"><a href="#plot_comparative_response-459"><span class="linenos">459</span></a><span class="sd">    Args:</span>
</span><span id="plot_comparative_response-460"><a href="#plot_comparative_response-460"><span class="linenos">460</span></a><span class="sd">    - wt_obj (Graph_data_container): List of graph containers</span>
</span><span id="plot_comparative_response-461"><a href="#plot_comparative_response-461"><span class="linenos">461</span></a><span class="sd">    - response_offset (float, optional): Setting a response offset.</span>
</span><span id="plot_comparative_response-462"><a href="#plot_comparative_response-462"><span class="linenos">462</span></a><span class="sd">        - Defaults to 2e-4.</span>
</span><span id="plot_comparative_response-463"><a href="#plot_comparative_response-463"><span class="linenos">463</span></a><span class="sd">    - figsize (tuple, optional): Determining the size of the produced figure.</span>
</span><span id="plot_comparative_response-464"><a href="#plot_comparative_response-464"><span class="linenos">464</span></a><span class="sd">        - Defaults to (16,9).</span>
</span><span id="plot_comparative_response-465"><a href="#plot_comparative_response-465"><span class="linenos">465</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="plot_comparative_response-466"><a href="#plot_comparative_response-466"><span class="linenos">466</span></a>    <span class="n">sig</span> <span class="o">=</span> <span class="n">wt_obj</span><span class="o">.</span><span class="n">data</span>
</span><span id="plot_comparative_response-467"><a href="#plot_comparative_response-467"><span class="linenos">467</span></a>    <span class="n">fs_Hz</span> <span class="o">=</span> <span class="n">wt_obj</span><span class="o">.</span><span class="n">fs_Hz</span>
</span><span id="plot_comparative_response-468"><a href="#plot_comparative_response-468"><span class="linenos">468</span></a>
</span><span id="plot_comparative_response-469"><a href="#plot_comparative_response-469"><span class="linenos">469</span></a>    <span class="n">filt_p</span> <span class="o">=</span> <span class="n">filter_func</span><span class="o">.</span><span class="n">params</span>
</span><span id="plot_comparative_response-470"><a href="#plot_comparative_response-470"><span class="linenos">470</span></a>    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">filt_p</span><span class="p">[</span><span class="s1">&#39;filter order&#39;</span><span class="p">],</span> <span class="n">Wn</span><span class="o">=</span><span class="n">filt_p</span><span class="p">[</span><span class="s1">&#39;fc_Hz&#39;</span><span class="p">],</span>
</span><span id="plot_comparative_response-471"><a href="#plot_comparative_response-471"><span class="linenos">471</span></a>                        <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;lp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-472"><a href="#plot_comparative_response-472"><span class="linenos">472</span></a>
</span><span id="plot_comparative_response-473"><a href="#plot_comparative_response-473"><span class="linenos">473</span></a>    <span class="n">filtered</span> <span class="o">=</span> <span class="n">filter_func</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">)</span>
</span><span id="plot_comparative_response-474"><a href="#plot_comparative_response-474"><span class="linenos">474</span></a>
</span><span id="plot_comparative_response-475"><a href="#plot_comparative_response-475"><span class="linenos">475</span></a>    <span class="c1"># calculate spectrum</span>
</span><span id="plot_comparative_response-476"><a href="#plot_comparative_response-476"><span class="linenos">476</span></a>    <span class="n">f</span><span class="p">,</span> <span class="n">Pxx_spec</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">,</span>
</span><span id="plot_comparative_response-477"><a href="#plot_comparative_response-477"><span class="linenos">477</span></a>                               <span class="n">window</span><span class="o">=</span><span class="s1">&#39;flattop&#39;</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span>
</span><span id="plot_comparative_response-478"><a href="#plot_comparative_response-478"><span class="linenos">478</span></a>                               <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-479"><a href="#plot_comparative_response-479"><span class="linenos">479</span></a>    <span class="n">f</span><span class="p">,</span> <span class="n">Pxx_spec_filt</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">welch</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">,</span>
</span><span id="plot_comparative_response-480"><a href="#plot_comparative_response-480"><span class="linenos">480</span></a>                                    <span class="n">window</span><span class="o">=</span><span class="s1">&#39;flattop&#39;</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span>
</span><span id="plot_comparative_response-481"><a href="#plot_comparative_response-481"><span class="linenos">481</span></a>                                    <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-482"><a href="#plot_comparative_response-482"><span class="linenos">482</span></a>
</span><span id="plot_comparative_response-483"><a href="#plot_comparative_response-483"><span class="linenos">483</span></a>    <span class="c1"># #TODO: this is for testing</span>
</span><span id="plot_comparative_response-484"><a href="#plot_comparative_response-484"><span class="linenos">484</span></a>    <span class="c1"># Pxx_spec= Pxx_spec**2</span>
</span><span id="plot_comparative_response-485"><a href="#plot_comparative_response-485"><span class="linenos">485</span></a>    <span class="c1"># Pxx_spec_filt = Pxx_spec_filt**2</span>
</span><span id="plot_comparative_response-486"><a href="#plot_comparative_response-486"><span class="linenos">486</span></a>
</span><span id="plot_comparative_response-487"><a href="#plot_comparative_response-487"><span class="linenos">487</span></a>    <span class="k">if</span> <span class="n">plot_th</span><span class="p">:</span>
</span><span id="plot_comparative_response-488"><a href="#plot_comparative_response-488"><span class="linenos">488</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sig</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="plot_comparative_response-489"><a href="#plot_comparative_response-489"><span class="linenos">489</span></a>                      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs_Hz</span>
</span><span id="plot_comparative_response-490"><a href="#plot_comparative_response-490"><span class="linenos">490</span></a>        <span class="c1"># plot time domain</span>
</span><span id="plot_comparative_response-491"><a href="#plot_comparative_response-491"><span class="linenos">491</span></a>        <span class="n">fig1</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="plot_comparative_response-492"><a href="#plot_comparative_response-492"><span class="linenos">492</span></a>                                        <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="plot_comparative_response-493"><a href="#plot_comparative_response-493"><span class="linenos">493</span></a>                                        <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
</span><span id="plot_comparative_response-494"><a href="#plot_comparative_response-494"><span class="linenos">494</span></a>        <span class="n">fig1</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
</span><span id="plot_comparative_response-495"><a href="#plot_comparative_response-495"><span class="linenos">495</span></a>            <span class="s1">&#39;Time Domain Filtering of signal with f1=10[Hz], f2=20[Hz] and noise&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-496"><a href="#plot_comparative_response-496"><span class="linenos">496</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
</span><span id="plot_comparative_response-497"><a href="#plot_comparative_response-497"><span class="linenos">497</span></a>        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;raw signal&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-498"><a href="#plot_comparative_response-498"><span class="linenos">498</span></a>        <span class="c1"># ax1.axis([0, 1, -2, 2])</span>
</span><span id="plot_comparative_response-499"><a href="#plot_comparative_response-499"><span class="linenos">499</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">filtered</span><span class="p">)</span>
</span><span id="plot_comparative_response-500"><a href="#plot_comparative_response-500"><span class="linenos">500</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;After filter&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-501"><a href="#plot_comparative_response-501"><span class="linenos">501</span></a>        <span class="c1"># ax2.axis([0, 1, -2, 2])</span>
</span><span id="plot_comparative_response-502"><a href="#plot_comparative_response-502"><span class="linenos">502</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [seconds]&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-503"><a href="#plot_comparative_response-503"><span class="linenos">503</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="plot_comparative_response-504"><a href="#plot_comparative_response-504"><span class="linenos">504</span></a>
</span><span id="plot_comparative_response-505"><a href="#plot_comparative_response-505"><span class="linenos">505</span></a>    <span class="n">wb</span><span class="p">,</span> <span class="n">hb</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfreqz</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
</span><span id="plot_comparative_response-506"><a href="#plot_comparative_response-506"><span class="linenos">506</span></a>                             <span class="n">whole</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">)</span>
</span><span id="plot_comparative_response-507"><a href="#plot_comparative_response-507"><span class="linenos">507</span></a>    <span class="n">fb</span> <span class="o">=</span> <span class="n">wb</span>   <span class="c1"># /(2*np.pi) # convert rad/s to Hz</span>
</span><span id="plot_comparative_response-508"><a href="#plot_comparative_response-508"><span class="linenos">508</span></a>
</span><span id="plot_comparative_response-509"><a href="#plot_comparative_response-509"><span class="linenos">509</span></a>    <span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="plot_comparative_response-510"><a href="#plot_comparative_response-510"><span class="linenos">510</span></a>                             <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
</span><span id="plot_comparative_response-511"><a href="#plot_comparative_response-511"><span class="linenos">511</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fb</span><span class="p">,</span>
</span><span id="plot_comparative_response-512"><a href="#plot_comparative_response-512"><span class="linenos">512</span></a>             <span class="n">response_offset</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hb</span><span class="p">)),</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="plot_comparative_response-513"><a href="#plot_comparative_response-513"><span class="linenos">513</span></a>             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;filter response&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-514"><a href="#plot_comparative_response-514"><span class="linenos">514</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Pxx_spec</span><span class="p">),</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-515"><a href="#plot_comparative_response-515"><span class="linenos">515</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Pxx_spec_filt</span><span class="p">),</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;filtered&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-516"><a href="#plot_comparative_response-516"><span class="linenos">516</span></a>    <span class="k">if</span> <span class="n">Kolmogorov_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="plot_comparative_response-517"><a href="#plot_comparative_response-517"><span class="linenos">517</span></a>        <span class="n">KOLMOGORV_CONSTANT</span> <span class="o">=</span> <span class="o">-</span> <span class="mf">5.0</span><span class="o">/</span><span class="mi">3</span>
</span><span id="plot_comparative_response-518"><a href="#plot_comparative_response-518"><span class="linenos">518</span></a>        <span class="n">xs</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="plot_comparative_response-519"><a href="#plot_comparative_response-519"><span class="linenos">519</span></a>        <span class="n">ys</span> <span class="o">=</span> <span class="n">xs</span><span class="o">**</span><span class="p">(</span><span class="n">KOLMOGORV_CONSTANT</span><span class="p">)</span><span class="o">*</span><span class="n">Kolmogorov_offset</span>
</span><span id="plot_comparative_response-520"><a href="#plot_comparative_response-520"><span class="linenos">520</span></a>        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Kolmogorov -5/3&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-521"><a href="#plot_comparative_response-521"><span class="linenos">521</span></a>
</span><span id="plot_comparative_response-522"><a href="#plot_comparative_response-522"><span class="linenos">522</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Filter frequency response (cutoff: </span><span class="si">{}</span><span class="s1">Hz) -  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="plot_comparative_response-523"><a href="#plot_comparative_response-523"><span class="linenos">523</span></a>        <span class="n">filter_func</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fc_Hz&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
</span><span id="plot_comparative_response-524"><a href="#plot_comparative_response-524"><span class="linenos">524</span></a>        <span class="n">wt_obj</span><span class="o">.</span><span class="n">description</span><span class="p">))</span>
</span><span id="plot_comparative_response-525"><a href="#plot_comparative_response-525"><span class="linenos">525</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-526"><a href="#plot_comparative_response-526"><span class="linenos">526</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Power Spectrum density [V**2/Hz]&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-527"><a href="#plot_comparative_response-527"><span class="linenos">527</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-528"><a href="#plot_comparative_response-528"><span class="linenos">528</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-529"><a href="#plot_comparative_response-529"><span class="linenos">529</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
</span><span id="plot_comparative_response-530"><a href="#plot_comparative_response-530"><span class="linenos">530</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
</span><span id="plot_comparative_response-531"><a href="#plot_comparative_response-531"><span class="linenos">531</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
</span><span id="plot_comparative_response-532"><a href="#plot_comparative_response-532"><span class="linenos">532</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
</span><span id="plot_comparative_response-533"><a href="#plot_comparative_response-533"><span class="linenos">533</span></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="plot_comparative_response-534"><a href="#plot_comparative_response-534"><span class="linenos">534</span></a>    <span class="c1"># plt.savefig(&#39;Bessel Filter Freq Response.png&#39;)</span>
</span></pre></div>


            <div class="docstring"><h1 id="tod-make-this-part-of-wt_noiproc">TOD make this part of WT_NoiProc.</h1>

<p>Args:</p>

<ul>
<li>wt_obj (Graph_data_container): List of graph containers</li>
<li>response_offset (float, optional): Setting a response offset.
<ul>
<li>Defaults to 2e-4.</li>
</ul></li>
<li>figsize (tuple, optional): Determining the size of the produced figure.
<ul>
<li>Defaults to (16,9).</li>
</ul></li>
</ul>
</div>


                </section>
                <section id="fir_factory_constructor">
                            <input id="fir_factory_constructor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fir_factory_constructor</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">fir_order</span><span class="o">=</span><span class="mi">32</span>, </span><span class="param"><span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">200</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="fir_factory_constructor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#fir_factory_constructor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="fir_factory_constructor-539"><a href="#fir_factory_constructor-539"><span class="linenos">539</span></a><span class="k">def</span> <span class="nf">fir_factory_constructor</span><span class="p">(</span><span class="n">fir_order</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">200</span><span class="p">):</span>
</span><span id="fir_factory_constructor-540"><a href="#fir_factory_constructor-540"><span class="linenos">540</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Mimicing so this is working with Papadakis solution above.</span>
</span><span id="fir_factory_constructor-541"><a href="#fir_factory_constructor-541"><span class="linenos">541</span></a>
</span><span id="fir_factory_constructor-542"><a href="#fir_factory_constructor-542"><span class="linenos">542</span></a><span class="sd">    Description</span>
</span><span id="fir_factory_constructor-543"><a href="#fir_factory_constructor-543"><span class="linenos">543</span></a><span class="sd">    -----------</span>
</span><span id="fir_factory_constructor-544"><a href="#fir_factory_constructor-544"><span class="linenos">544</span></a><span class="sd">    Now we can use the `.filter()` class method to filter with a simple</span>
</span><span id="fir_factory_constructor-545"><a href="#fir_factory_constructor-545"><span class="linenos">545</span></a><span class="sd">    low-pass `FIR`. The idea is to be able to construct tables for standard</span>
</span><span id="fir_factory_constructor-546"><a href="#fir_factory_constructor-546"><span class="linenos">546</span></a><span class="sd">    deviation comparison of the methods. This can be also used to define the</span>
</span><span id="fir_factory_constructor-547"><a href="#fir_factory_constructor-547"><span class="linenos">547</span></a><span class="sd">    needed fir filter and plot the results with:</span>
</span><span id="fir_factory_constructor-548"><a href="#fir_factory_constructor-548"><span class="linenos">548</span></a><span class="sd">      - `plot_comparative_response(wt_obj, filter_func)`</span>
</span><span id="fir_factory_constructor-549"><a href="#fir_factory_constructor-549"><span class="linenos">549</span></a><span class="sd">      - wherever we use the `filter_func` keyword to select the filtering</span>
</span><span id="fir_factory_constructor-550"><a href="#fir_factory_constructor-550"><span class="linenos">550</span></a><span class="sd">        function.</span>
</span><span id="fir_factory_constructor-551"><a href="#fir_factory_constructor-551"><span class="linenos">551</span></a>
</span><span id="fir_factory_constructor-552"><a href="#fir_factory_constructor-552"><span class="linenos">552</span></a>
</span><span id="fir_factory_constructor-553"><a href="#fir_factory_constructor-553"><span class="linenos">553</span></a><span class="sd">    Usage</span>
</span><span id="fir_factory_constructor-554"><a href="#fir_factory_constructor-554"><span class="linenos">554</span></a><span class="sd">    ------</span>
</span><span id="fir_factory_constructor-555"><a href="#fir_factory_constructor-555"><span class="linenos">555</span></a><span class="sd">    ```python</span>
</span><span id="fir_factory_constructor-556"><a href="#fir_factory_constructor-556"><span class="linenos">556</span></a><span class="sd">    from pros_noisefiltering.WT_NoiProc import fir_factory_constructor</span>
</span><span id="fir_factory_constructor-557"><a href="#fir_factory_constructor-557"><span class="linenos">557</span></a>
</span><span id="fir_factory_constructor-558"><a href="#fir_factory_constructor-558"><span class="linenos">558</span></a><span class="sd">    fir_200 = fir_factory_constructor(fir_order=60, fc_Hz=200)</span>
</span><span id="fir_factory_constructor-559"><a href="#fir_factory_constructor-559"><span class="linenos">559</span></a><span class="sd">    fir_filt_200 = ca1_0.filter(fc_Hz=2_00, filter_func=fir_200).data</span>
</span><span id="fir_factory_constructor-560"><a href="#fir_factory_constructor-560"><span class="linenos">560</span></a><span class="sd">    ```</span>
</span><span id="fir_factory_constructor-561"><a href="#fir_factory_constructor-561"><span class="linenos">561</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="fir_factory_constructor-562"><a href="#fir_factory_constructor-562"><span class="linenos">562</span></a>    <span class="k">def</span> <span class="nf">fir_filter</span><span class="p">(</span><span class="n">ds</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="fir_factory_constructor-563"><a href="#fir_factory_constructor-563"><span class="linenos">563</span></a>                   <span class="n">fs_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="fir_factory_constructor-564"><a href="#fir_factory_constructor-564"><span class="linenos">564</span></a>                   <span class="n">fir_filt_order</span><span class="o">=</span><span class="n">fir_order</span><span class="p">):</span>
</span><span id="fir_factory_constructor-565"><a href="#fir_factory_constructor-565"><span class="linenos">565</span></a>
</span><span id="fir_factory_constructor-566"><a href="#fir_factory_constructor-566"><span class="linenos">566</span></a>        <span class="n">fir_filt_coeff</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="o">=</span><span class="n">fir_filt_order</span><span class="p">,</span>
</span><span id="fir_factory_constructor-567"><a href="#fir_factory_constructor-567"><span class="linenos">567</span></a>                                       <span class="n">fs</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">,</span>
</span><span id="fir_factory_constructor-568"><a href="#fir_factory_constructor-568"><span class="linenos">568</span></a>                                       <span class="n">cutoff</span><span class="o">=</span><span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="fir_factory_constructor-569"><a href="#fir_factory_constructor-569"><span class="linenos">569</span></a>                                       <span class="c1"># pass_zero=False ,</span>
</span><span id="fir_factory_constructor-570"><a href="#fir_factory_constructor-570"><span class="linenos">570</span></a>                                       <span class="c1"># scale= True,</span>
</span><span id="fir_factory_constructor-571"><a href="#fir_factory_constructor-571"><span class="linenos">571</span></a>                                       <span class="p">)</span>
</span><span id="fir_factory_constructor-572"><a href="#fir_factory_constructor-572"><span class="linenos">572</span></a>        <span class="c1"># # Hann approach</span>
</span><span id="fir_factory_constructor-573"><a href="#fir_factory_constructor-573"><span class="linenos">573</span></a>        <span class="c1"># fir_filt_coeff=signal.firwin(fir_order + 1,</span>
</span><span id="fir_factory_constructor-574"><a href="#fir_factory_constructor-574"><span class="linenos">574</span></a>        <span class="c1">#                              [0, 200/fs_hz],</span>
</span><span id="fir_factory_constructor-575"><a href="#fir_factory_constructor-575"><span class="linenos">575</span></a>        <span class="c1">#                              fs=fs_hz , window=&#39;hann&#39;)</span>
</span><span id="fir_factory_constructor-576"><a href="#fir_factory_constructor-576"><span class="linenos">576</span></a>
</span><span id="fir_factory_constructor-577"><a href="#fir_factory_constructor-577"><span class="linenos">577</span></a>        <span class="c1"># make output sos type to ensure normal operation</span>
</span><span id="fir_factory_constructor-578"><a href="#fir_factory_constructor-578"><span class="linenos">578</span></a>        <span class="c1"># this is crusial for elimination of ending ripples see image above</span>
</span><span id="fir_factory_constructor-579"><a href="#fir_factory_constructor-579"><span class="linenos">579</span></a>        <span class="n">sos_fir_mode</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">tf2sos</span><span class="p">(</span><span class="n">fir_filt_coeff</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="fir_factory_constructor-580"><a href="#fir_factory_constructor-580"><span class="linenos">580</span></a>        <span class="n">sos_filt_data</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos_fir_mode</span><span class="p">,</span> <span class="n">ds</span><span class="o">-</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="fir_factory_constructor-581"><a href="#fir_factory_constructor-581"><span class="linenos">581</span></a>        <span class="c1"># warmup = fir_filt_order-1</span>
</span><span id="fir_factory_constructor-582"><a href="#fir_factory_constructor-582"><span class="linenos">582</span></a>        <span class="c1"># uncorrupted_output = sos_filt_data[warmup:]</span>
</span><span id="fir_factory_constructor-583"><a href="#fir_factory_constructor-583"><span class="linenos">583</span></a>        <span class="c1"># filt_sig_time_int = time[warmup:]-((warmup/2)/fs_hz)</span>
</span><span id="fir_factory_constructor-584"><a href="#fir_factory_constructor-584"><span class="linenos">584</span></a>        <span class="c1"># return uncorrupted_output           # uncorr_sos_output</span>
</span><span id="fir_factory_constructor-585"><a href="#fir_factory_constructor-585"><span class="linenos">585</span></a>        <span class="k">return</span> <span class="n">sos_filt_data</span>
</span><span id="fir_factory_constructor-586"><a href="#fir_factory_constructor-586"><span class="linenos">586</span></a>
</span><span id="fir_factory_constructor-587"><a href="#fir_factory_constructor-587"><span class="linenos">587</span></a>    <span class="c1"># Add the parameter attribute for checking filter response</span>
</span><span id="fir_factory_constructor-588"><a href="#fir_factory_constructor-588"><span class="linenos">588</span></a>    <span class="n">fir_filter</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;filter order&#39;</span><span class="p">:</span> <span class="n">fir_order</span><span class="p">,</span> <span class="s1">&#39;fc_Hz&#39;</span><span class="p">:</span> <span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="fir_factory_constructor-589"><a href="#fir_factory_constructor-589"><span class="linenos">589</span></a>                         <span class="s1">&#39;filter type&#39;</span><span class="p">:</span> <span class="s1">&#39;simple fir&#39;</span><span class="p">}</span>
</span><span id="fir_factory_constructor-590"><a href="#fir_factory_constructor-590"><span class="linenos">590</span></a>    <span class="k">return</span> <span class="n">fir_filter</span>
</span></pre></div>


            <div class="docstring"><p>Mimicing so this is working with Papadakis solution above.</p>

<h2 id="description">Description</h2>

<p>Now we can use the <code>.filter()</code> class method to filter with a simple
low-pass <code>FIR</code>. The idea is to be able to construct tables for standard
deviation comparison of the methods. This can be also used to define the
needed fir filter and plot the results with:</p>

<ul>
<li><code>plot_comparative_response(wt_obj, filter_func)</code></li>
<li>wherever we use the <code>filter_func</code> keyword to select the filtering
function.</li>
</ul>

<h2 id="usage">Usage</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn"><a href="">pros_noisefiltering.WT_NoiProc</a></span> <span class="kn">import</span> <span class="n">fir_factory_constructor</span>

<span class="n">fir_200</span> <span class="o">=</span> <span class="n">fir_factory_constructor</span><span class="p">(</span><span class="n">fir_order</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">fir_filt_200</span> <span class="o">=</span> <span class="n">ca1_0</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">fc_Hz</span><span class="o">=</span><span class="mi">2_00</span><span class="p">,</span> <span class="n">filter_func</span><span class="o">=</span><span class="n">fir_200</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
</code></pre>
</div>
</div>


                </section>
                <section id="filter_fir_default">
                            <input id="filter_fir_default-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_fir_default</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">ds</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">fs_Hz</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span>,</span><span class="param">	<span class="n">fir_filt_order</span><span class="o">=</span><span class="mi">2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="filter_fir_default-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#filter_fir_default"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="filter_fir_default-562"><a href="#filter_fir_default-562"><span class="linenos">562</span></a>    <span class="k">def</span> <span class="nf">fir_filter</span><span class="p">(</span><span class="n">ds</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="filter_fir_default-563"><a href="#filter_fir_default-563"><span class="linenos">563</span></a>                   <span class="n">fs_Hz</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fc_Hz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="filter_fir_default-564"><a href="#filter_fir_default-564"><span class="linenos">564</span></a>                   <span class="n">fir_filt_order</span><span class="o">=</span><span class="n">fir_order</span><span class="p">):</span>
</span><span id="filter_fir_default-565"><a href="#filter_fir_default-565"><span class="linenos">565</span></a>
</span><span id="filter_fir_default-566"><a href="#filter_fir_default-566"><span class="linenos">566</span></a>        <span class="n">fir_filt_coeff</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="o">=</span><span class="n">fir_filt_order</span><span class="p">,</span>
</span><span id="filter_fir_default-567"><a href="#filter_fir_default-567"><span class="linenos">567</span></a>                                       <span class="n">fs</span><span class="o">=</span><span class="n">fs_Hz</span><span class="p">,</span>
</span><span id="filter_fir_default-568"><a href="#filter_fir_default-568"><span class="linenos">568</span></a>                                       <span class="n">cutoff</span><span class="o">=</span><span class="n">fc_Hz</span><span class="p">,</span>
</span><span id="filter_fir_default-569"><a href="#filter_fir_default-569"><span class="linenos">569</span></a>                                       <span class="c1"># pass_zero=False ,</span>
</span><span id="filter_fir_default-570"><a href="#filter_fir_default-570"><span class="linenos">570</span></a>                                       <span class="c1"># scale= True,</span>
</span><span id="filter_fir_default-571"><a href="#filter_fir_default-571"><span class="linenos">571</span></a>                                       <span class="p">)</span>
</span><span id="filter_fir_default-572"><a href="#filter_fir_default-572"><span class="linenos">572</span></a>        <span class="c1"># # Hann approach</span>
</span><span id="filter_fir_default-573"><a href="#filter_fir_default-573"><span class="linenos">573</span></a>        <span class="c1"># fir_filt_coeff=signal.firwin(fir_order + 1,</span>
</span><span id="filter_fir_default-574"><a href="#filter_fir_default-574"><span class="linenos">574</span></a>        <span class="c1">#                              [0, 200/fs_hz],</span>
</span><span id="filter_fir_default-575"><a href="#filter_fir_default-575"><span class="linenos">575</span></a>        <span class="c1">#                              fs=fs_hz , window=&#39;hann&#39;)</span>
</span><span id="filter_fir_default-576"><a href="#filter_fir_default-576"><span class="linenos">576</span></a>
</span><span id="filter_fir_default-577"><a href="#filter_fir_default-577"><span class="linenos">577</span></a>        <span class="c1"># make output sos type to ensure normal operation</span>
</span><span id="filter_fir_default-578"><a href="#filter_fir_default-578"><span class="linenos">578</span></a>        <span class="c1"># this is crusial for elimination of ending ripples see image above</span>
</span><span id="filter_fir_default-579"><a href="#filter_fir_default-579"><span class="linenos">579</span></a>        <span class="n">sos_fir_mode</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">tf2sos</span><span class="p">(</span><span class="n">fir_filt_coeff</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="filter_fir_default-580"><a href="#filter_fir_default-580"><span class="linenos">580</span></a>        <span class="n">sos_filt_data</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos_fir_mode</span><span class="p">,</span> <span class="n">ds</span><span class="o">-</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="filter_fir_default-581"><a href="#filter_fir_default-581"><span class="linenos">581</span></a>        <span class="c1"># warmup = fir_filt_order-1</span>
</span><span id="filter_fir_default-582"><a href="#filter_fir_default-582"><span class="linenos">582</span></a>        <span class="c1"># uncorrupted_output = sos_filt_data[warmup:]</span>
</span><span id="filter_fir_default-583"><a href="#filter_fir_default-583"><span class="linenos">583</span></a>        <span class="c1"># filt_sig_time_int = time[warmup:]-((warmup/2)/fs_hz)</span>
</span><span id="filter_fir_default-584"><a href="#filter_fir_default-584"><span class="linenos">584</span></a>        <span class="c1"># return uncorrupted_output           # uncorr_sos_output</span>
</span><span id="filter_fir_default-585"><a href="#filter_fir_default-585"><span class="linenos">585</span></a>        <span class="k">return</span> <span class="n">sos_filt_data</span>
</span></pre></div>


    

                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>